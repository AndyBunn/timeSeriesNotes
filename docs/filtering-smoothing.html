<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>11 Filtering, smoothing | A collection of note for ESCI 504</title>
  <meta name="description" content="Helpful materials for ESCI 504" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="11 Filtering, smoothing | A collection of note for ESCI 504" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Helpful materials for ESCI 504" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="11 Filtering, smoothing | A collection of note for ESCI 504" />
  
  <meta name="twitter:description" content="Helpful materials for ESCI 504" />
  

<meta name="author" content="Andy Bunn" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="regression.html"/>
<link rel="next" href="the-freqs-come-out-at-night.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.33/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // if code block has been labeled with class `fold-show`, show the code on init!
    var classList = $(this).attr('class').split(/\s+/);
    for (var i = 0; i < classList.length; i++) {
    if (classList[i] === 'fold-show') {
        show = true;
      }
      // AGB add fold-hide
    if (classList[i] === 'fold-hide') {
        show = false;
      }
    }
    // AGB
    // if code block has been labeled with class `fold-hide`, hide the code on init!
//    var classList = $(this).attr('class').split(/\s+/);
//    for (var i = 0; i < classList.length; i++) {
//    if (classList[i] === 'fold-hide') {
//        show = false;
//      }
//    }

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // hack: return show to false, otherwise all next codeBlocks will be shown!
    show = true;

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<style type="text/css">
.code-folding-btn {
  margin-bottom: 4px;
}

.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}

.open > .dropdown-menu {
    display: block;
    color: #ffffff;
    background-color: #ffffff;
    background-image: none;
    border-color: #92897e;
}

.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: 400;
  line-height: 1.42857143;
  color: #000000;
  white-space: nowrap;
}

.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
}

.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
  outline: 0;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #aea79f;
}

.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  cursor: not-allowed;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
}

.btn {
  display: inline-block;
  margin-bottom: 1;
  font-weight: normal;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  -ms-touch-action: manipulation;
      touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  padding: 4px 8px;
  font-size: 14px;
  line-height: 1.42857143;
  border-radius: 4px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #ffffff;
  text-decoration: none;
}
.btn:active,
.btn.active {
  background-image: none;
  outline: 0;
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  filter: alpha(opacity=65);
  opacity: 0.65;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #ffffff;
  background-color: #aea79f; #important
  border-color: #aea79f;
}

.btn-default:focus,
.btn-default.focus {
  color: #ffffff;
  background-color: #978e83;
  border-color: #6f675e;
}

.btn-default:hover {
  color: #ffffff;
  background-color: #978e83;
  border-color: #92897e;
}
.btn-default:active,
.btn-default.active,
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-right: 8px;
  padding-left: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-right: 12px;
  padding-left: 12px;
}
.btn-group.open .dropdown-toggle {
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  box-shadow: none;
}

</style>
<script>
var str = '<div class="btn-group pull-right" style="position: fixed; right: 50px; top: 10px; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" id="allCodeButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>';
document.write(str);
</script>
<script>
$(document).ready(function () {
  // AGB add fold-hide changed === to !== to default to showing code
  window.initializeCodeFolding("show" !== "hide");
});
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preamble</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#technical-setup"><i class="fa fa-check"></i><b>1.1</b> Technical Setup</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#project-structure"><i class="fa fa-check"></i><b>1.1.1</b> Project Structure</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#why-use-projects-in-r"><i class="fa fa-check"></i><b>1.1.2</b> Why Use Projects in R?</a></li>
<li class="chapter" data-level="1.1.3" data-path="index.html"><a href="index.html#why-reproducibility-matters"><i class="fa fa-check"></i><b>1.1.3</b> Why Reproducibility Matters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-measure-of-time.html"><a href="the-measure-of-time.html"><i class="fa fa-check"></i><b>2</b> The Measure of Time</a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-measure-of-time.html"><a href="the-measure-of-time.html#big-idea"><i class="fa fa-check"></i><b>2.1</b> Big Idea</a></li>
<li class="chapter" data-level="2.2" data-path="the-measure-of-time.html"><a href="the-measure-of-time.html#reading"><i class="fa fa-check"></i><b>2.2</b> Reading</a></li>
<li class="chapter" data-level="2.3" data-path="the-measure-of-time.html"><a href="the-measure-of-time.html#packages"><i class="fa fa-check"></i><b>2.3</b> Packages</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="the-measure-of-time.html"><a href="the-measure-of-time.html#load"><i class="fa fa-check"></i><b>2.3.1</b> Load</a></li>
<li class="chapter" data-level="2.3.2" data-path="the-measure-of-time.html"><a href="the-measure-of-time.html#keep-up-to-date"><i class="fa fa-check"></i><b>2.3.2</b> Keep Up to Date</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="the-measure-of-time.html"><a href="the-measure-of-time.html#what-kinds-of-data"><i class="fa fa-check"></i><b>2.4</b> What Kinds of Data?</a></li>
<li class="chapter" data-level="2.5" data-path="the-measure-of-time.html"><a href="the-measure-of-time.html#the-ts-class"><i class="fa fa-check"></i><b>2.5</b> The <code>ts</code> Class</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="the-measure-of-time.html"><a href="the-measure-of-time.html#a-very-useful-class"><i class="fa fa-check"></i><b>2.5.1</b> A Very Useful Class</a></li>
<li class="chapter" data-level="2.5.2" data-path="the-measure-of-time.html"><a href="the-measure-of-time.html#digression-describing-a-time-series"><i class="fa fa-check"></i><b>2.5.2</b> Digression: Describing a Time Series</a></li>
<li class="chapter" data-level="2.5.3" data-path="the-measure-of-time.html"><a href="the-measure-of-time.html#more-on-the-ts-index"><i class="fa fa-check"></i><b>2.5.3</b> More on the <code>ts</code> Index</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="the-measure-of-time.html"><a href="the-measure-of-time.html#trend-in-time"><i class="fa fa-check"></i><b>2.6</b> Trend in time</a></li>
<li class="chapter" data-level="2.7" data-path="the-measure-of-time.html"><a href="the-measure-of-time.html#the-zoo-class"><i class="fa fa-check"></i><b>2.7</b> The <code>zoo</code> Class</a></li>
<li class="chapter" data-level="2.8" data-path="the-measure-of-time.html"><a href="the-measure-of-time.html#lubricate-the-dates"><i class="fa fa-check"></i><b>2.8</b> Lubricate the Dates</a></li>
<li class="chapter" data-level="2.9" data-path="the-measure-of-time.html"><a href="the-measure-of-time.html#tidy-it-up"><i class="fa fa-check"></i><b>2.9</b> Tidy it Up</a></li>
<li class="chapter" data-level="2.10" data-path="the-measure-of-time.html"><a href="the-measure-of-time.html#your-work"><i class="fa fa-check"></i><b>2.10</b> Your Work</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="the-measure-of-time.html"><a href="the-measure-of-time.html#berkeley-earth-temperature-data"><i class="fa fa-check"></i><b>2.10.1</b> Berkeley Earth Temperature Data</a></li>
<li class="chapter" data-level="2.10.2" data-path="the-measure-of-time.html"><a href="the-measure-of-time.html#your-turn"><i class="fa fa-check"></i><b>2.10.2</b> Your Turn</a></li>
<li class="chapter" data-level="2.10.3" data-path="the-measure-of-time.html"><a href="the-measure-of-time.html#write-up-and-reflect"><i class="fa fa-check"></i><b>2.10.3</b> Write Up and Reflect</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="an-aside-understanding-methods-and-generics-in-r.html"><a href="an-aside-understanding-methods-and-generics-in-r.html"><i class="fa fa-check"></i><b>3</b> An Aside: Understanding Methods and Generics in R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="an-aside-understanding-methods-and-generics-in-r.html"><a href="an-aside-understanding-methods-and-generics-in-r.html#youve-come-a-long-way-in-r"><i class="fa fa-check"></i><b>3.1</b> You’ve Come a Long Way in R</a></li>
<li class="chapter" data-level="3.2" data-path="an-aside-understanding-methods-and-generics-in-r.html"><a href="an-aside-understanding-methods-and-generics-in-r.html#why-use-generics"><i class="fa fa-check"></i><b>3.2</b> Why Use Generics?</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="an-aside-understanding-methods-and-generics-in-r.html"><a href="an-aside-understanding-methods-and-generics-in-r.html#same-function-different-behavior-what-gives"><i class="fa fa-check"></i><b>3.2.1</b> Same Function, Different Behavior — What Gives?</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="an-aside-understanding-methods-and-generics-in-r.html"><a href="an-aside-understanding-methods-and-generics-in-r.html#how-this-works"><i class="fa fa-check"></i><b>3.3</b> How This Works</a></li>
<li class="chapter" data-level="3.4" data-path="an-aside-understanding-methods-and-generics-in-r.html"><a href="an-aside-understanding-methods-and-generics-in-r.html#whats-the-difference-between-a-generic-and-a-method"><i class="fa fa-check"></i><b>3.4</b> What’s the Difference Between a Generic and a Method?</a></li>
<li class="chapter" data-level="3.5" data-path="an-aside-understanding-methods-and-generics-in-r.html"><a href="an-aside-understanding-methods-and-generics-in-r.html#common-generic-functions"><i class="fa fa-check"></i><b>3.5</b> Common Generic Functions</a></li>
<li class="chapter" data-level="3.6" data-path="an-aside-understanding-methods-and-generics-in-r.html"><a href="an-aside-understanding-methods-and-generics-in-r.html#how-to-explore-and-understand-methods"><i class="fa fa-check"></i><b>3.6</b> How to Explore and Understand Methods</a></li>
<li class="chapter" data-level="3.7" data-path="an-aside-understanding-methods-and-generics-in-r.html"><a href="an-aside-understanding-methods-and-generics-in-r.html#why-this-matters"><i class="fa fa-check"></i><b>3.7</b> Why This Matters</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="decomposition.html"><a href="decomposition.html"><i class="fa fa-check"></i><b>4</b> Decomposition</a>
<ul>
<li class="chapter" data-level="4.1" data-path="decomposition.html"><a href="decomposition.html#big-idea-1"><i class="fa fa-check"></i><b>4.1</b> Big Idea</a></li>
<li class="chapter" data-level="4.2" data-path="decomposition.html"><a href="decomposition.html#reading-1"><i class="fa fa-check"></i><b>4.2</b> Reading</a></li>
<li class="chapter" data-level="4.3" data-path="decomposition.html"><a href="decomposition.html#packages-1"><i class="fa fa-check"></i><b>4.3</b> Packages</a></li>
<li class="chapter" data-level="4.4" data-path="decomposition.html"><a href="decomposition.html#seasonality-and-decomposition"><i class="fa fa-check"></i><b>4.4</b> Seasonality and decomposition</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="decomposition.html"><a href="decomposition.html#breaking-down-a-series-the-tedious-way"><i class="fa fa-check"></i><b>4.4.1</b> Breaking down a series the tedious way</a></li>
<li class="chapter" data-level="4.4.2" data-path="decomposition.html"><a href="decomposition.html#breaking-down-a-series-the-easy-way"><i class="fa fa-check"></i><b>4.4.2</b> Breaking down a series the easy way</a></li>
<li class="chapter" data-level="4.4.3" data-path="decomposition.html"><a href="decomposition.html#how-does-m-differ-from-the-slope-in-a-lm"><i class="fa fa-check"></i><b>4.4.3</b> How does <code>m</code> differ from the slope in a <code>lm</code>?</a></li>
<li class="chapter" data-level="4.4.4" data-path="decomposition.html"><a href="decomposition.html#warning"><i class="fa fa-check"></i><b>4.4.4</b> Warning</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="decomposition.html"><a href="decomposition.html#stationarity"><i class="fa fa-check"></i><b>4.5</b> Stationarity</a></li>
<li class="chapter" data-level="4.6" data-path="decomposition.html"><a href="decomposition.html#your-work-1"><i class="fa fa-check"></i><b>4.6</b> Your Work</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="decomposition.html"><a href="decomposition.html#air-passengers"><i class="fa fa-check"></i><b>4.6.1</b> Air Passengers</a></li>
<li class="chapter" data-level="4.6.2" data-path="decomposition.html"><a href="decomposition.html#kbli"><i class="fa fa-check"></i><b>4.6.2</b> KBLI</a></li>
<li class="chapter" data-level="4.6.3" data-path="decomposition.html"><a href="decomposition.html#write-up-and-reflect-1"><i class="fa fa-check"></i><b>4.6.3</b> Write Up and Reflect</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="arp-acf-pacf-etc..html"><a href="arp-acf-pacf-etc..html"><i class="fa fa-check"></i><b>5</b> AR(p), ACF, PACF, etc.</a>
<ul>
<li class="chapter" data-level="5.1" data-path="arp-acf-pacf-etc..html"><a href="arp-acf-pacf-etc..html#big-idea-2"><i class="fa fa-check"></i><b>5.1</b> Big Idea</a></li>
<li class="chapter" data-level="5.2" data-path="arp-acf-pacf-etc..html"><a href="arp-acf-pacf-etc..html#reading-2"><i class="fa fa-check"></i><b>5.2</b> Reading</a></li>
<li class="chapter" data-level="5.3" data-path="arp-acf-pacf-etc..html"><a href="arp-acf-pacf-etc..html#packages-2"><i class="fa fa-check"></i><b>5.3</b> Packages</a></li>
<li class="chapter" data-level="5.4" data-path="arp-acf-pacf-etc..html"><a href="arp-acf-pacf-etc..html#correlation-and-covariance"><i class="fa fa-check"></i><b>5.4</b> Correlation and Covariance</a></li>
<li class="chapter" data-level="5.5" data-path="arp-acf-pacf-etc..html"><a href="arp-acf-pacf-etc..html#autocorrelation"><i class="fa fa-check"></i><b>5.5</b> Autocorrelation</a></li>
<li class="chapter" data-level="5.6" data-path="arp-acf-pacf-etc..html"><a href="arp-acf-pacf-etc..html#autocorrelation-function"><i class="fa fa-check"></i><b>5.6</b> Autocorrelation Function</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="arp-acf-pacf-etc..html"><a href="arp-acf-pacf-etc..html#the-very-fun-presentation"><i class="fa fa-check"></i><b>5.6.1</b> The Very Fun Presentation</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="arp-acf-pacf-etc..html"><a href="arp-acf-pacf-etc..html#the-boring-presentation"><i class="fa fa-check"></i><b>5.7</b> The Boring Presentation</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="arp-acf-pacf-etc..html"><a href="arp-acf-pacf-etc..html#tidy"><i class="fa fa-check"></i><b>5.7.1</b> Tidy</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="arp-acf-pacf-etc..html"><a href="arp-acf-pacf-etc..html#partial-autocorrelation-function"><i class="fa fa-check"></i><b>5.8</b> Partial Autocorrelation Function</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="arp-acf-pacf-etc..html"><a href="arp-acf-pacf-etc..html#pacf"><i class="fa fa-check"></i><b>5.8.1</b> PACF</a></li>
<li class="chapter" data-level="5.8.2" data-path="arp-acf-pacf-etc..html"><a href="arp-acf-pacf-etc..html#underneath-the-hood-of-pacf"><i class="fa fa-check"></i><b>5.8.2</b> Underneath the Hood of PACF</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="arp-acf-pacf-etc..html"><a href="arp-acf-pacf-etc..html#ar1-to-arp"><i class="fa fa-check"></i><b>5.9</b> AR(1) to AR(p)</a></li>
<li class="chapter" data-level="5.10" data-path="arp-acf-pacf-etc..html"><a href="arp-acf-pacf-etc..html#random-walks"><i class="fa fa-check"></i><b>5.10</b> Random walks</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="arp-acf-pacf-etc..html"><a href="arp-acf-pacf-etc..html#stationarity-is-dead"><i class="fa fa-check"></i><b>5.10.1</b> Stationarity is dead</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="arp-acf-pacf-etc..html"><a href="arp-acf-pacf-etc..html#autocorrelation-examples-with-real-data"><i class="fa fa-check"></i><b>5.11</b> Autocorrelation examples with real data</a>
<ul>
<li class="chapter" data-level="5.11.1" data-path="arp-acf-pacf-etc..html"><a href="arp-acf-pacf-etc..html#nile"><i class="fa fa-check"></i><b>5.11.1</b> Nile</a></li>
<li class="chapter" data-level="5.11.2" data-path="arp-acf-pacf-etc..html"><a href="arp-acf-pacf-etc..html#air-temperature"><i class="fa fa-check"></i><b>5.11.2</b> Air Temperature</a></li>
<li class="chapter" data-level="5.11.3" data-path="arp-acf-pacf-etc..html"><a href="arp-acf-pacf-etc..html#sunspots"><i class="fa fa-check"></i><b>5.11.3</b> Sunspots</a></li>
</ul></li>
<li class="chapter" data-level="5.12" data-path="arp-acf-pacf-etc..html"><a href="arp-acf-pacf-etc..html#choosing-the-order-of-an-arp-model-by-aic"><i class="fa fa-check"></i><b>5.12</b> Choosing the Order of an AR(p) Model by AIC</a></li>
<li class="chapter" data-level="5.13" data-path="arp-acf-pacf-etc..html"><a href="arp-acf-pacf-etc..html#your-work-2"><i class="fa fa-check"></i><b>5.13</b> Your work</a>
<ul>
<li class="chapter" data-level="5.13.1" data-path="arp-acf-pacf-etc..html"><a href="arp-acf-pacf-etc..html#acf-and-pacf-with-different-values-of-phi."><i class="fa fa-check"></i><b>5.13.1</b> ACF and PACF with different values of <span class="math inline">\(\phi\)</span>.</a></li>
<li class="chapter" data-level="5.13.2" data-path="arp-acf-pacf-etc..html"><a href="arp-acf-pacf-etc..html#roll-your-own-ar2"><i class="fa fa-check"></i><b>5.13.2</b> Roll your own AR(2)</a></li>
<li class="chapter" data-level="5.13.3" data-path="arp-acf-pacf-etc..html"><a href="arp-acf-pacf-etc..html#sockeye"><i class="fa fa-check"></i><b>5.13.3</b> Sockeye</a></li>
<li class="chapter" data-level="5.13.4" data-path="arp-acf-pacf-etc..html"><a href="arp-acf-pacf-etc..html#write-up-and-reflect-2"><i class="fa fa-check"></i><b>5.13.4</b> Write Up and Reflect</a></li>
</ul></li>
<li class="chapter" data-level="5.14" data-path="arp-acf-pacf-etc..html"><a href="arp-acf-pacf-etc..html#postscript-a-helpful-plotting-chunk"><i class="fa fa-check"></i><b>5.14</b> Postscript: A Helpful Plotting Chunk</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="aside-why-the-acf-and-pacf-look-the-way-they-do-in-an-ma1-process.html"><a href="aside-why-the-acf-and-pacf-look-the-way-they-do-in-an-ma1-process.html"><i class="fa fa-check"></i><b>6</b> Aside: Why the ACF and PACF Look the Way They Do in an MA(1) Process</a>
<ul>
<li class="chapter" data-level="6.1" data-path="aside-why-the-acf-and-pacf-look-the-way-they-do-in-an-ma1-process.html"><a href="aside-why-the-acf-and-pacf-look-the-way-they-do-in-an-ma1-process.html#introduction"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="aside-why-the-acf-and-pacf-look-the-way-they-do-in-an-ma1-process.html"><a href="aside-why-the-acf-and-pacf-look-the-way-they-do-in-an-ma1-process.html#acf-and-pacf-of-a-single-ma1-simulation"><i class="fa fa-check"></i><b>6.2</b> ACF and PACF of a Single MA(1) Simulation</a></li>
<li class="chapter" data-level="6.3" data-path="aside-why-the-acf-and-pacf-look-the-way-they-do-in-an-ma1-process.html"><a href="aside-why-the-acf-and-pacf-look-the-way-they-do-in-an-ma1-process.html#simulation-study-across-many-ma1-coefficients"><i class="fa fa-check"></i><b>6.3</b> Simulation Study Across Many MA(1) Coefficients</a></li>
<li class="chapter" data-level="6.4" data-path="aside-why-the-acf-and-pacf-look-the-way-they-do-in-an-ma1-process.html"><a href="aside-why-the-acf-and-pacf-look-the-way-they-do-in-an-ma1-process.html#insight-1-pacf-lag-1-underestimates-theta"><i class="fa fa-check"></i><b>6.4</b> Insight 1: PACF Lag 1 Underestimates <span class="math inline">\(\theta\)</span></a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="aside-why-the-acf-and-pacf-look-the-way-they-do-in-an-ma1-process.html"><a href="aside-why-the-acf-and-pacf-look-the-way-they-do-in-an-ma1-process.html#why-this-happens"><i class="fa fa-check"></i><b>6.4.1</b> Why This Happens</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="aside-why-the-acf-and-pacf-look-the-way-they-do-in-an-ma1-process.html"><a href="aside-why-the-acf-and-pacf-look-the-way-they-do-in-an-ma1-process.html#insight-2-pacf-lag-2-is-consistently-negative"><i class="fa fa-check"></i><b>6.5</b> Insight 2: PACF Lag 2 is Consistently Negative</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="aside-why-the-acf-and-pacf-look-the-way-they-do-in-an-ma1-process.html"><a href="aside-why-the-acf-and-pacf-look-the-way-they-do-in-an-ma1-process.html#why-this-happens-1"><i class="fa fa-check"></i><b>6.5.1</b> Why This Happens</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="aside-why-the-acf-and-pacf-look-the-way-they-do-in-an-ma1-process.html"><a href="aside-why-the-acf-and-pacf-look-the-way-they-do-in-an-ma1-process.html#conclusion"><i class="fa fa-check"></i><b>6.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="armapq.html"><a href="armapq.html"><i class="fa fa-check"></i><b>7</b> ARMA(p,q)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="armapq.html"><a href="armapq.html#big-idea-3"><i class="fa fa-check"></i><b>7.1</b> Big Idea</a></li>
<li class="chapter" data-level="7.2" data-path="armapq.html"><a href="armapq.html#reading-3"><i class="fa fa-check"></i><b>7.2</b> Reading</a></li>
<li class="chapter" data-level="7.3" data-path="armapq.html"><a href="armapq.html#packages-3"><i class="fa fa-check"></i><b>7.3</b> Packages</a></li>
<li class="chapter" data-level="7.4" data-path="armapq.html"><a href="armapq.html#arp-to-maq"><i class="fa fa-check"></i><b>7.4</b> AR(p) to MA(q)</a></li>
<li class="chapter" data-level="7.5" data-path="armapq.html"><a href="armapq.html#armapq-1"><i class="fa fa-check"></i><b>7.5</b> ARMA(p,q)</a></li>
<li class="chapter" data-level="7.6" data-path="armapq.html"><a href="armapq.html#what-about-arimap-d-q"><i class="fa fa-check"></i><b>7.6</b> What about ARIMA(p, d, q)?</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="armapq.html"><a href="armapq.html#why-do-arma-models-require-stationarity"><i class="fa fa-check"></i><b>7.6.1</b> Why Do ARMA Models Require Stationarity?</a></li>
<li class="chapter" data-level="7.6.2" data-path="armapq.html"><a href="armapq.html#simulated-data"><i class="fa fa-check"></i><b>7.6.2</b> Simulated Data</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="armapq.html"><a href="armapq.html#evaluating-arma-models"><i class="fa fa-check"></i><b>7.7</b> Evaluating ARMA models</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="armapq.html"><a href="armapq.html#simulated-data-1"><i class="fa fa-check"></i><b>7.7.1</b> Simulated Data</a></li>
<li class="chapter" data-level="7.7.2" data-path="armapq.html"><a href="armapq.html#sst-data"><i class="fa fa-check"></i><b>7.7.2</b> SST Data</a></li>
<li class="chapter" data-level="7.7.3" data-path="armapq.html"><a href="armapq.html#how-do-you-decide-which-information-criterion-to-use"><i class="fa fa-check"></i><b>7.7.3</b> How Do You Decide Which Information Criterion to Use?</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="armapq.html"><a href="armapq.html#your-work-3"><i class="fa fa-check"></i><b>7.8</b> Your work</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="armapq.html"><a href="armapq.html#bunnies-and-kitties"><i class="fa fa-check"></i><b>7.8.1</b> Bunnies and Kitties</a></li>
<li class="chapter" data-level="7.8.2" data-path="armapq.html"><a href="armapq.html#write-up-and-reflect-3"><i class="fa fa-check"></i><b>7.8.2</b> Write up and Reflect</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="forecasting.html"><a href="forecasting.html"><i class="fa fa-check"></i><b>8</b> Forecasting</a>
<ul>
<li class="chapter" data-level="8.1" data-path="forecasting.html"><a href="forecasting.html#big-idea-4"><i class="fa fa-check"></i><b>8.1</b> Big Idea</a></li>
<li class="chapter" data-level="8.2" data-path="forecasting.html"><a href="forecasting.html#reading-4"><i class="fa fa-check"></i><b>8.2</b> Reading</a></li>
<li class="chapter" data-level="8.3" data-path="forecasting.html"><a href="forecasting.html#packages-4"><i class="fa fa-check"></i><b>8.3</b> Packages</a></li>
<li class="chapter" data-level="8.4" data-path="forecasting.html"><a href="forecasting.html#introduction-1"><i class="fa fa-check"></i><b>8.4</b> Introduction</a></li>
<li class="chapter" data-level="8.5" data-path="forecasting.html"><a href="forecasting.html#a-simple-forecast"><i class="fa fa-check"></i><b>8.5</b> A simple forecast</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="forecasting.html"><a href="forecasting.html#two-step-ahead-forecast"><i class="fa fa-check"></i><b>8.5.1</b> Two-step-ahead forecast</a></li>
<li class="chapter" data-level="8.5.2" data-path="forecasting.html"><a href="forecasting.html#example"><i class="fa fa-check"></i><b>8.5.2</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="forecasting.html"><a href="forecasting.html#using-arma-coefficients-to-forecast"><i class="fa fa-check"></i><b>8.6</b> Using ARMA coefficients to forecast</a></li>
<li class="chapter" data-level="8.7" data-path="forecasting.html"><a href="forecasting.html#holt-winters"><i class="fa fa-check"></i><b>8.7</b> Holt-Winters</a></li>
<li class="chapter" data-level="8.8" data-path="forecasting.html"><a href="forecasting.html#your-work-4"><i class="fa fa-check"></i><b>8.8</b> Your work</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="forecasting.html"><a href="forecasting.html#a-silly-prediction"><i class="fa fa-check"></i><b>8.8.1</b> A silly prediction</a></li>
<li class="chapter" data-level="8.8.2" data-path="forecasting.html"><a href="forecasting.html#write-up-and-reflect-4"><i class="fa fa-check"></i><b>8.8.2</b> Write Up and Reflect</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="cross-correlation.html"><a href="cross-correlation.html"><i class="fa fa-check"></i><b>9</b> Cross Correlation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="cross-correlation.html"><a href="cross-correlation.html#big-idea-5"><i class="fa fa-check"></i><b>9.1</b> Big Idea</a></li>
<li class="chapter" data-level="9.2" data-path="cross-correlation.html"><a href="cross-correlation.html#reading-5"><i class="fa fa-check"></i><b>9.2</b> Reading</a></li>
<li class="chapter" data-level="9.3" data-path="cross-correlation.html"><a href="cross-correlation.html#packages-5"><i class="fa fa-check"></i><b>9.3</b> Packages</a></li>
<li class="chapter" data-level="9.4" data-path="cross-correlation.html"><a href="cross-correlation.html#lags"><i class="fa fa-check"></i><b>9.4</b> Lags</a></li>
<li class="chapter" data-level="9.5" data-path="cross-correlation.html"><a href="cross-correlation.html#from-acf-to-ccf"><i class="fa fa-check"></i><b>9.5</b> From ACF to CCF</a></li>
<li class="chapter" data-level="9.6" data-path="cross-correlation.html"><a href="cross-correlation.html#how-ccf-normalizes-correlations"><i class="fa fa-check"></i><b>9.6</b> How <code>Ccf()</code> Normalizes Correlations</a></li>
<li class="chapter" data-level="9.7" data-path="cross-correlation.html"><a href="cross-correlation.html#your-work-5"><i class="fa fa-check"></i><b>9.7</b> Your work</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="cross-correlation.html"><a href="cross-correlation.html#write-up-and-reflect-5"><i class="fa fa-check"></i><b>9.7.1</b> Write Up and Reflect</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>10</b> Regression</a>
<ul>
<li class="chapter" data-level="10.1" data-path="regression.html"><a href="regression.html#big-idea-6"><i class="fa fa-check"></i><b>10.1</b> Big Idea</a></li>
<li class="chapter" data-level="10.2" data-path="regression.html"><a href="regression.html#reading-6"><i class="fa fa-check"></i><b>10.2</b> Reading</a></li>
<li class="chapter" data-level="10.3" data-path="regression.html"><a href="regression.html#packages-6"><i class="fa fa-check"></i><b>10.3</b> Packages</a></li>
<li class="chapter" data-level="10.4" data-path="regression.html"><a href="regression.html#regression-1"><i class="fa fa-check"></i><b>10.4</b> Regression</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="regression.html"><a href="regression.html#adjusting-ols"><i class="fa fa-check"></i><b>10.4.1</b> Adjusting OLS</a></li>
<li class="chapter" data-level="10.4.2" data-path="regression.html"><a href="regression.html#gls"><i class="fa fa-check"></i><b>10.4.2</b> GLS</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="regression.html"><a href="regression.html#your-work-6"><i class="fa fa-check"></i><b>10.5</b> Your work</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="regression.html"><a href="regression.html#what-does-generalized-mean"><i class="fa fa-check"></i><b>10.5.1</b> What Does Generalized Mean?</a></li>
<li class="chapter" data-level="10.5.2" data-path="regression.html"><a href="regression.html#regression-simulation"><i class="fa fa-check"></i><b>10.5.2</b> Regression Simulation</a></li>
<li class="chapter" data-level="10.5.3" data-path="regression.html"><a href="regression.html#regression-for-real"><i class="fa fa-check"></i><b>10.5.3</b> Regression for real</a></li>
<li class="chapter" data-level="10.5.4" data-path="regression.html"><a href="regression.html#write-up-and-reflect-6"><i class="fa fa-check"></i><b>10.5.4</b> Write Up and Reflect</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="filtering-smoothing.html"><a href="filtering-smoothing.html"><i class="fa fa-check"></i><b>11</b> Filtering, smoothing</a>
<ul>
<li class="chapter" data-level="11.1" data-path="filtering-smoothing.html"><a href="filtering-smoothing.html#big-idea-7"><i class="fa fa-check"></i><b>11.1</b> Big Idea</a></li>
<li class="chapter" data-level="11.2" data-path="filtering-smoothing.html"><a href="filtering-smoothing.html#packages-7"><i class="fa fa-check"></i><b>11.2</b> Packages</a></li>
<li class="chapter" data-level="11.3" data-path="filtering-smoothing.html"><a href="filtering-smoothing.html#filters-as-visual-aids"><i class="fa fa-check"></i><b>11.3</b> Filters as visual aids</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="filtering-smoothing.html"><a href="filtering-smoothing.html#moving-running-average"><i class="fa fa-check"></i><b>11.3.1</b> Moving (running) average</a></li>
<li class="chapter" data-level="11.3.2" data-path="filtering-smoothing.html"><a href="filtering-smoothing.html#hanning"><i class="fa fa-check"></i><b>11.3.2</b> Hanning</a></li>
<li class="chapter" data-level="11.3.3" data-path="filtering-smoothing.html"><a href="filtering-smoothing.html#smoothing-splines"><i class="fa fa-check"></i><b>11.3.3</b> Smoothing splines</a></li>
<li class="chapter" data-level="11.3.4" data-path="filtering-smoothing.html"><a href="filtering-smoothing.html#loess"><i class="fa fa-check"></i><b>11.3.4</b> Loess</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="filtering-smoothing.html"><a href="filtering-smoothing.html#using-filters"><i class="fa fa-check"></i><b>11.4</b> Using filters</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="filtering-smoothing.html"><a href="filtering-smoothing.html#aggregating"><i class="fa fa-check"></i><b>11.4.1</b> Aggregating</a></li>
<li class="chapter" data-level="11.4.2" data-path="filtering-smoothing.html"><a href="filtering-smoothing.html#removing-low-frequency-variability"><i class="fa fa-check"></i><b>11.4.2</b> Removing low frequency variability</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="filtering-smoothing.html"><a href="filtering-smoothing.html#the-case-of-the-poorly-launched-sensors"><i class="fa fa-check"></i><b>11.5</b> The Case of the Poorly-Launched Sensors</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="filtering-smoothing.html"><a href="filtering-smoothing.html#fix-time-on-temperature"><i class="fa fa-check"></i><b>11.5.1</b> Fix time on temperature</a></li>
<li class="chapter" data-level="11.5.2" data-path="filtering-smoothing.html"><a href="filtering-smoothing.html#fill-missing-data-on-radiation"><i class="fa fa-check"></i><b>11.5.2</b> Fill missing data on radiation</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="filtering-smoothing.html"><a href="filtering-smoothing.html#your-work-7"><i class="fa fa-check"></i><b>11.6</b> Your work</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="filtering-smoothing.html"><a href="filtering-smoothing.html#filter"><i class="fa fa-check"></i><b>11.6.1</b> Filter</a></li>
<li class="chapter" data-level="11.6.2" data-path="filtering-smoothing.html"><a href="filtering-smoothing.html#revisit-the-case-of-the-poorly-launched-sensors"><i class="fa fa-check"></i><b>11.6.2</b> Revisit the case of the poorly launched sensors</a></li>
<li class="chapter" data-level="11.6.3" data-path="filtering-smoothing.html"><a href="filtering-smoothing.html#write-up-and-reflect-7"><i class="fa fa-check"></i><b>11.6.3</b> Write Up and Reflect</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="the-freqs-come-out-at-night.html"><a href="the-freqs-come-out-at-night.html"><i class="fa fa-check"></i><b>12</b> The Freqs Come out at Night</a>
<ul>
<li class="chapter" data-level="12.1" data-path="the-freqs-come-out-at-night.html"><a href="the-freqs-come-out-at-night.html#big-idea-8"><i class="fa fa-check"></i><b>12.1</b> Big Idea</a></li>
<li class="chapter" data-level="12.2" data-path="the-freqs-come-out-at-night.html"><a href="the-freqs-come-out-at-night.html#reading-7"><i class="fa fa-check"></i><b>12.2</b> Reading</a></li>
<li class="chapter" data-level="12.3" data-path="the-freqs-come-out-at-night.html"><a href="the-freqs-come-out-at-night.html#packages-8"><i class="fa fa-check"></i><b>12.3</b> Packages</a></li>
<li class="chapter" data-level="12.4" data-path="the-freqs-come-out-at-night.html"><a href="the-freqs-come-out-at-night.html#the-frequency-domain"><i class="fa fa-check"></i><b>12.4</b> The Frequency Domain</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="the-freqs-come-out-at-night.html"><a href="the-freqs-come-out-at-night.html#same-data-two-domains"><i class="fa fa-check"></i><b>12.4.1</b> Same Data, Two Domains</a></li>
<li class="chapter" data-level="12.4.2" data-path="the-freqs-come-out-at-night.html"><a href="the-freqs-come-out-at-night.html#worked-example"><i class="fa fa-check"></i><b>12.4.2</b> Worked example</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="the-freqs-come-out-at-night.html"><a href="the-freqs-come-out-at-night.html#sunspot-example"><i class="fa fa-check"></i><b>12.5</b> Sunspot Example</a></li>
<li class="chapter" data-level="12.6" data-path="the-freqs-come-out-at-night.html"><a href="the-freqs-come-out-at-night.html#your-work-8"><i class="fa fa-check"></i><b>12.6</b> Your work</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="the-freqs-come-out-at-night.html"><a href="the-freqs-come-out-at-night.html#generate-three-signals"><i class="fa fa-check"></i><b>12.6.1</b> Generate three signals</a></li>
<li class="chapter" data-level="12.6.2" data-path="the-freqs-come-out-at-night.html"><a href="the-freqs-come-out-at-night.html#milankovitch"><i class="fa fa-check"></i><b>12.6.2</b> Milankovitch</a></li>
<li class="chapter" data-level="12.6.3" data-path="the-freqs-come-out-at-night.html"><a href="the-freqs-come-out-at-night.html#write-up-and-reflect-8"><i class="fa fa-check"></i><b>12.6.3</b> Write Up and Reflect</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="the-freqs-come-out-at-night.html"><a href="the-freqs-come-out-at-night.html#references"><i class="fa fa-check"></i><b>12.7</b> References</a></li>
<li class="chapter" data-level="12.8" data-path="the-freqs-come-out-at-night.html"><a href="the-freqs-come-out-at-night.html#postscript-a-glimpse-of-wavelets"><i class="fa fa-check"></i><b>12.8</b> Postscript: A Glimpse of Wavelets</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i><b>13</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A collection of note for ESCI 504</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="filtering-smoothing" class="section level1 hasAnchor" number="11">
<h1><span class="header-section-number">11</span> Filtering, smoothing<a href="filtering-smoothing.html#filtering-smoothing" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="big-idea-7" class="section level2 hasAnchor" number="11.1">
<h2><span class="header-section-number">11.1</span> Big Idea<a href="filtering-smoothing.html#big-idea-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Very often one wants to smooth or filter data to analyze or work only with particular aspects of the data. This kind of analysis is a big deal in time-series analysis. Smoothing is a way of isolating different frequencies of data but still thinking in the time domain.</p>
</div>
<div id="packages-7" class="section level2 hasAnchor" number="11.2">
<h2><span class="header-section-number">11.2</span> Packages<a href="filtering-smoothing.html#packages-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You will want the <code>dplR</code> <span class="citation">(<a href="references-1.html#ref-R-dplR">Bunn et al. 2025</a>)</span> package – a subtle work of staggering genius – as well as <code>zoo</code> <span class="citation">(<a href="references-1.html#ref-R-zoo">Zeileis, Grothendieck, and Ryan 2025</a>)</span> and <code>hydroTSM</code> <span class="citation">(<a href="references-1.html#ref-R-hydroTSM">Zambrano-Bigiarini 2024</a>)</span>.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="filtering-smoothing.html#cb284-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb284-2"><a href="filtering-smoothing.html#cb284-2" tabindex="-1"></a><span class="fu">library</span>(dplR)</span>
<span id="cb284-3"><a href="filtering-smoothing.html#cb284-3" tabindex="-1"></a><span class="fu">library</span>(hydroTSM)</span>
<span id="cb284-4"><a href="filtering-smoothing.html#cb284-4" tabindex="-1"></a><span class="fu">library</span>(zoo)</span></code></pre></div>
</div>
<div id="filters-as-visual-aids" class="section level2 hasAnchor" number="11.3">
<h2><span class="header-section-number">11.3</span> Filters as visual aids<a href="filtering-smoothing.html#filters-as-visual-aids" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Recall the very simple moving average filters we made earlier in class? Let’s revisit. People who work with time series are forever adding smooth lines to their plots in order to highlight signal and de-emphasize noise. It’s like a sickness. And everybody has a different way of doing it. We already looked at moving averages using the <code>filter()</code> function. Let’s just take a quick peek at some other common ones.</p>
<p>We’ve been using a lot simulated data, which is something I really like to do. It’s good for setting up situations where we want to see if we understand how a method works. But let’s use some tree-ring data this time to demonstrate a few different smoothing options.</p>
<p>This is a tree-ring chronology from near the arctic treeline in Canada that is one of the onboard data sets in <code>dplR</code>. I’ve pulled out the years for plotting.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="filtering-smoothing.html#cb285-1" tabindex="-1"></a><span class="fu">data</span>(cana157)</span>
<span id="cb285-2"><a href="filtering-smoothing.html#cb285-2" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">yrs =</span> <span class="fu">time</span>(cana157), <span class="at">Z =</span> <span class="fu">scale</span>(cana157[,<span class="dv">1</span>]))</span>
<span id="cb285-3"><a href="filtering-smoothing.html#cb285-3" tabindex="-1"></a>nyrs <span class="ot">&lt;-</span> <span class="fu">nrow</span>(dat)</span>
<span id="cb285-4"><a href="filtering-smoothing.html#cb285-4" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb285-5"><a href="filtering-smoothing.html#cb285-5" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb285-6"><a href="filtering-smoothing.html#cb285-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>dat, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>yrs,<span class="at">y=</span>Z), <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb285-7"><a href="filtering-smoothing.html#cb285-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Year&quot;</span>,<span class="at">y=</span><span class="st">&quot;Tree Growth (Z-Score)&quot;</span>, </span>
<span id="cb285-8"><a href="filtering-smoothing.html#cb285-8" tabindex="-1"></a>       <span class="at">title=</span><span class="st">&quot;Twisted Tree Heartrot Hill Tree-Ring Chronology&quot;</span>) <span class="sc">+</span></span>
<span id="cb285-9"><a href="filtering-smoothing.html#cb285-9" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb285-10"><a href="filtering-smoothing.html#cb285-10" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="08TimeSeries-Filters_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div id="moving-running-average" class="section level3 hasAnchor" number="11.3.1">
<h3><span class="header-section-number">11.3.1</span> Moving (running) average<a href="filtering-smoothing.html#moving-running-average" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We’ve already looked at moving averages (aka running averages). Let’s revisit. These have the advantage of being dirt simple. Below we will see that they definitely emphasize low frequency in the examples below (at 20, 50, and 100 years) but retain some jaggedness too.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="filtering-smoothing.html#cb286-1" tabindex="-1"></a>sfPal <span class="ot">&lt;-</span> PNWColors<span class="sc">::</span><span class="fu">pnw_palette</span>(<span class="at">name=</span><span class="st">&quot;Starfish&quot;</span>,<span class="at">n=</span><span class="dv">3</span>,<span class="at">type=</span><span class="st">&quot;discrete&quot;</span>)</span>
<span id="cb286-2"><a href="filtering-smoothing.html#cb286-2" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> </span>
<span id="cb286-3"><a href="filtering-smoothing.html#cb286-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ma20 =</span> <span class="fu">c</span>(stats<span class="sc">::</span><span class="fu">filter</span>(<span class="at">x=</span>Z, <span class="at">filter=</span><span class="fu">rep</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>,<span class="at">times=</span><span class="dv">20</span>), <span class="at">sides=</span><span class="dv">2</span>)),</span>
<span id="cb286-4"><a href="filtering-smoothing.html#cb286-4" tabindex="-1"></a>         <span class="at">ma50 =</span> <span class="fu">c</span>(stats<span class="sc">::</span><span class="fu">filter</span>(<span class="at">x=</span>Z, <span class="at">filter=</span><span class="fu">rep</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">50</span>,<span class="at">times=</span><span class="dv">50</span>), <span class="at">sides=</span><span class="dv">2</span>)),</span>
<span id="cb286-5"><a href="filtering-smoothing.html#cb286-5" tabindex="-1"></a>         <span class="at">ma100 =</span> <span class="fu">c</span>(stats<span class="sc">::</span><span class="fu">filter</span>(<span class="at">x=</span>Z, <span class="at">filter=</span><span class="fu">rep</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">100</span>,<span class="at">times=</span><span class="dv">100</span>), <span class="at">sides=</span><span class="dv">2</span>)))</span>
<span id="cb286-6"><a href="filtering-smoothing.html#cb286-6" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Moving Average Filters&quot;</span>) <span class="sc">+</span></span>
<span id="cb286-7"><a href="filtering-smoothing.html#cb286-7" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>dat, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>yrs,<span class="at">y=</span>ma20), <span class="at">color =</span> sfPal[<span class="dv">1</span>],<span class="at">linewidth=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb286-8"><a href="filtering-smoothing.html#cb286-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>dat, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>yrs,<span class="at">y=</span>ma50), <span class="at">color =</span> sfPal[<span class="dv">2</span>],<span class="at">linewidth=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb286-9"><a href="filtering-smoothing.html#cb286-9" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>dat, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>yrs,<span class="at">y=</span>ma100), <span class="at">color =</span> sfPal[<span class="dv">3</span>],<span class="at">linewidth=</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 19 rows containing missing values or values outside the scale range
## (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 49 rows containing missing values or values outside the scale range
## (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 99 rows containing missing values or values outside the scale range
## (`geom_line()`).</code></pre>
<p><img src="08TimeSeries-Filters_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="hanning" class="section level3 hasAnchor" number="11.3.2">
<h3><span class="header-section-number">11.3.2</span> Hanning<a href="filtering-smoothing.html#hanning" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Hanning filter is similar to the moving average in the sense that the curve emphasizes low frequency variability and loses the jaggedness over the moving average. It’s also a simple filter (look at the code by typing <code>hanning</code> at the <code>R</code> prompt) but it is a start into thinking in the frequency domain. It’s part of a family of functions called window functions that are zero-valued outside of some interval chosen by the user. It’s used quite a bit by time-series wonks and it is implemented in <code>dplR</code> with the function <code>hanning()</code>. I’ll skip the theory here but it’s a great precursor to the work we will do with spectral analysis next week.</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="filtering-smoothing.html#cb290-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> </span>
<span id="cb290-2"><a href="filtering-smoothing.html#cb290-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">han20 =</span> <span class="fu">hanning</span>(Z,<span class="at">n=</span><span class="dv">20</span>),</span>
<span id="cb290-3"><a href="filtering-smoothing.html#cb290-3" tabindex="-1"></a>         <span class="at">han50 =</span> <span class="fu">hanning</span>(Z,<span class="at">n=</span><span class="dv">50</span>),</span>
<span id="cb290-4"><a href="filtering-smoothing.html#cb290-4" tabindex="-1"></a>         <span class="at">han100 =</span> <span class="fu">hanning</span>(Z,<span class="at">n=</span><span class="dv">100</span>))</span>
<span id="cb290-5"><a href="filtering-smoothing.html#cb290-5" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Hanning Filters&quot;</span>) <span class="sc">+</span></span>
<span id="cb290-6"><a href="filtering-smoothing.html#cb290-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>dat, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>yrs,<span class="at">y=</span>han20), <span class="at">color =</span> sfPal[<span class="dv">1</span>],<span class="at">linewidth=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb290-7"><a href="filtering-smoothing.html#cb290-7" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>dat, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>yrs,<span class="at">y=</span>han50), <span class="at">color =</span> sfPal[<span class="dv">2</span>],<span class="at">linewidth=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb290-8"><a href="filtering-smoothing.html#cb290-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>dat, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>yrs,<span class="at">y=</span>han100), <span class="at">color =</span> sfPal[<span class="dv">3</span>],<span class="at">linewidth=</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 19 rows containing missing values or values outside the scale range
## (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 49 rows containing missing values or values outside the scale range
## (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 99 rows containing missing values or values outside the scale range
## (`geom_line()`).</code></pre>
<p><img src="08TimeSeries-Filters_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Like the moving average the smooth is shorter than the input data. It’s too bad because its nice to preserve the ends of the data but there is much wringing of hands and gnashing of teeth about the “right” way of running a smoothing algorithm where the data are sparse. This so-called end-member problem is the subject of a lot of work in the time-series literature.</p>
<p>Let’s look at <code>dat</code>. Here are the first 75 rows in a sortable table.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="filtering-smoothing.html#cb294-1" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="fu">round</span>(dat,<span class="dv">2</span>),<span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">75</span>))</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-25d19f70ed3b04491bc5" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-25d19f70ed3b04491bc5">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463"],[1530,1531,1532,1533,1534,1535,1536,1537,1538,1539,1540,1541,1542,1543,1544,1545,1546,1547,1548,1549,1550,1551,1552,1553,1554,1555,1556,1557,1558,1559,1560,1561,1562,1563,1564,1565,1566,1567,1568,1569,1570,1571,1572,1573,1574,1575,1576,1577,1578,1579,1580,1581,1582,1583,1584,1585,1586,1587,1588,1589,1590,1591,1592,1593,1594,1595,1596,1597,1598,1599,1600,1601,1602,1603,1604,1605,1606,1607,1608,1609,1610,1611,1612,1613,1614,1615,1616,1617,1618,1619,1620,1621,1622,1623,1624,1625,1626,1627,1628,1629,1630,1631,1632,1633,1634,1635,1636,1637,1638,1639,1640,1641,1642,1643,1644,1645,1646,1647,1648,1649,1650,1651,1652,1653,1654,1655,1656,1657,1658,1659,1660,1661,1662,1663,1664,1665,1666,1667,1668,1669,1670,1671,1672,1673,1674,1675,1676,1677,1678,1679,1680,1681,1682,1683,1684,1685,1686,1687,1688,1689,1690,1691,1692,1693,1694,1695,1696,1697,1698,1699,1700,1701,1702,1703,1704,1705,1706,1707,1708,1709,1710,1711,1712,1713,1714,1715,1716,1717,1718,1719,1720,1721,1722,1723,1724,1725,1726,1727,1728,1729,1730,1731,1732,1733,1734,1735,1736,1737,1738,1739,1740,1741,1742,1743,1744,1745,1746,1747,1748,1749,1750,1751,1752,1753,1754,1755,1756,1757,1758,1759,1760,1761,1762,1763,1764,1765,1766,1767,1768,1769,1770,1771,1772,1773,1774,1775,1776,1777,1778,1779,1780,1781,1782,1783,1784,1785,1786,1787,1788,1789,1790,1791,1792,1793,1794,1795,1796,1797,1798,1799,1800,1801,1802,1803,1804,1805,1806,1807,1808,1809,1810,1811,1812,1813,1814,1815,1816,1817,1818,1819,1820,1821,1822,1823,1824,1825,1826,1827,1828,1829,1830,1831,1832,1833,1834,1835,1836,1837,1838,1839,1840,1841,1842,1843,1844,1845,1846,1847,1848,1849,1850,1851,1852,1853,1854,1855,1856,1857,1858,1859,1860,1861,1862,1863,1864,1865,1866,1867,1868,1869,1870,1871,1872,1873,1874,1875,1876,1877,1878,1879,1880,1881,1882,1883,1884,1885,1886,1887,1888,1889,1890,1891,1892,1893,1894,1895,1896,1897,1898,1899,1900,1901,1902,1903,1904,1905,1906,1907,1908,1909,1910,1911,1912,1913,1914,1915,1916,1917,1918,1919,1920,1921,1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992],[[2.69],[1.17],[2.25],[0.74],[0.63],[2.47],[0.2],[2.04],[0.74],[1.28],[0.09],[1.17],[0.74],[-0.13],[0.09],[1.61],[1.71],[-0.13],[2.04],[1.39],[0.96],[2.69],[2.25],[-0.35],[0.8100000000000001],[0.45],[0.18],[0.48],[1.39],[1.76],[0.31],[-0.88],[1.7],[2.25],[1.17],[0.31],[0.74],[0.23],[1.18],[0.73],[-0.68],[-1.27],[-0.73],[0.09],[-0.44],[0.8100000000000001],[-0.5600000000000001],[-0.5600000000000001],[-0.07000000000000001],[0.09],[-0.28],[-0.5600000000000001],[-0.13],[-1.21],[-0.12],[-0.77],[-1.32],[-1.21],[-0.5600000000000001],[0.13],[0.63],[-0.78],[-0.53],[-1.32],[-0.13],[0.71],[-0.41],[2.47],[0.2],[2.25],[-0.13],[0.39],[-0.13],[0.7],[0.48],[-0.62],[0.17],[-1.38],[-1.24],[-1.07],[-1.99],[-2.2],[-2.27],[-1.37],[-0.9],[-0.96],[-0.78],[-0.47],[-1.31],[-1.55],[-0.47],[-0.59],[-1.21],[-0.9399999999999999],[-0.64],[-0.6],[-0.28],[-0.97],[-1.14],[-0.17],[-0.26],[-1.91],[-0.58],[-0.48],[0.49],[-0.97],[0.6],[0.58],[0.24],[1.08],[2.12],[0.85],[0.46],[0.42],[0.66],[0.06],[-0.87],[0.11],[-0.44],[0.51],[0.74],[-0.13],[0.63],[-0.02],[1.39],[-0.14],[0.26],[0.19],[0.08],[-0.6899999999999999],[1.03],[1.26],[0.12],[0.06],[0.42],[-0.49],[-0.2],[-0.67],[0.7],[0.88],[-0.92],[-1.28],[0.05],[0.48],[-1.82],[-0.51],[0.09],[0.43],[1.56],[1.06],[0.43],[0.67],[0.5600000000000001],[0.71],[0.29],[-0.71],[-0.17],[-1.5],[-0.6],[-0.95],[-0.2],[0.03],[0.75],[-0.14],[1.29],[-0.2],[0.66],[1.12],[-0.37],[-0.92],[-2.23],[-1.35],[-1.01],[-1.02],[-1.12],[-1.46],[-1],[-0.17],[-0.32],[-0.77],[-1.01],[-2.23],[-2.27],[-0.66],[-1.77],[-1.2],[-1.29],[-1.83],[-1.46],[-1.05],[-0.05],[-1.68],[-0.13],[-0.29],[-0.19],[0.15],[0.66],[1.86],[-0.46],[1.05],[1.02],[0.16],[-0.31],[0.76],[0.29],[0.08],[-0.01],[0.86],[-0.31],[1.25],[0.45],[-0.27],[-0.47],[0.23],[-0.73],[0.46],[0.62],[0.22],[0.66],[1.17],[0.85],[-0.23],[0.45],[0.68],[-0.23],[-1.21],[0.95],[-1.33],[-0.38],[-0.52],[0.41],[1.83],[-0.35],[0.02],[-0.66],[-1.56],[-0.33],[-0.21],[0.22],[-0.36],[0.88],[0.57],[1.65],[-0.22],[0.12],[0.3],[-0.11],[0.04],[0.19],[-0.59],[-0.79],[0.39],[-1.17],[-0.7],[-1.11],[-0.48],[0.46],[0.57],[-0.59],[-0.74],[0.1],[0.05],[0.65],[1.41],[0.22],[0.5600000000000001],[0.67],[0.78],[0.77],[0.18],[0.37],[1.33],[0.27],[-0.84],[0.71],[0.34],[1.02],[0.27],[1.1],[0.25],[-0.19],[-0.5600000000000001],[-1.02],[0.28],[-1.24],[-1.02],[-0.64],[-1.4],[-0.39],[-1.6],[-1.46],[-2.11],[-1.57],[-1.09],[-1.7],[-0.99],[-0.87],[-1.38],[-0.21],[-0.99],[-1.55],[-1.63],[-0.5600000000000001],[-0.36],[-0.79],[-1.97],[-0.92],[-0.46],[-0.46],[-1.33],[-0.76],[-1.18],[-1.34],[-0.9399999999999999],[-0.6899999999999999],[-1.45],[-1.31],[-1.31],[-0.06],[-1.88],[-2.34],[-0.87],[-0.59],[-0.39],[-0.42],[-0.45],[-1.63],[-0.35],[0.11],[0.57],[-0.26],[-0.09],[-0.43],[-0.9399999999999999],[-0.14],[0.19],[0.2],[0.54],[-0.4],[-0.82],[-0.76],[0.61],[-1],[-0.47],[0],[0.93],[0.22],[-0.68],[-0.87],[-0.26],[-0.49],[-0.02],[0.26],[-0.6],[0.52],[0.1],[0.52],[-1.31],[1.87],[0.6899999999999999],[0.53],[0.8100000000000001],[-0.91],[0.48],[-0.46],[0.49],[0.88],[0.67],[0.66],[0.6],[-0.66],[0.74],[0.32],[1.09],[-0.35],[0.6899999999999999],[0.65],[0.66],[0.58],[0.5600000000000001],[-0.02],[0.02],[-0.6899999999999999],[1.12],[0.5600000000000001],[-0.04],[0.04],[0.53],[0.76],[-0.36],[0.63],[0.36],[0.48],[2.5],[0.89],[0.84],[0.5],[1.2],[0.15],[0.24],[0.9399999999999999],[0.3],[0.01],[0.15],[2.02],[2.63],[2.1],[1.46],[1.75],[2.23],[0.12],[1.29],[0.32],[0.62],[0.34],[1.39],[1.79],[0.63],[1.52],[-0.5600000000000001],[1.38],[-0.08],[0.75],[0.89],[1.54],[0.78],[0.1],[0.7],[1.54],[0.59],[1.05],[2.23],[1.53],[0.15],[2.52],[1.84],[1.7],[0.5],[1.19],[0.48],[-0.66],[0.91],[0.45],[-0.84],[-0.22],[-0.29],[-0.74],[-0.09],[-0.19],[-1.32],[-0.45],[-1.1],[0.34],[-0.06],[-0.92],[-0.92],[-0.87],[-1.64],[-1.81],[-1.26],[-1.71],[-2.52],[-1.9]],[null,null,null,null,null,null,null,null,null,1.14,1.05,1.13,1.13,1.07,1.08,0.98,0.98,0.9,0.9399999999999999,0.96,0.97,0.87,0.92,1.04,1.09,1.02,0.98,0.99,0.95,0.92,0.84,0.64,0.49,0.51,0.45,0.47,0.43,0.38,0.3,0.22,0.19,0.21,0.12,-0.06,-0.12,-0.18,-0.28,-0.35,-0.44,-0.47,-0.4,-0.38,-0.37,-0.44,-0.42,-0.43,-0.42,-0.27,-0.25,-0.15,-0.14,-0.09,-0.09,0,0.03,0.04,0.12,0.11,0.07000000000000001,0.01,-0.12,-0.19,-0.28,-0.28,-0.32,-0.4,-0.42,-0.57,-0.64,-0.83,-0.85,-0.9,-0.95,-1.03,-1.09,-1.09,-1.11,-1.09,-1.09,-1.04,-0.95,-0.9399999999999999,-0.86,-0.8100000000000001,-0.74,-0.74,-0.67,-0.62,-0.54,-0.41,-0.28,-0.21,-0.13,-0.06,0.01,0.04,0.01,0.07000000000000001,0.1,0.13,0.18,0.27,0.33,0.36,0.4,0.44,0.43,0.41,0.4,0.31,0.26,0.28,0.26,0.24,0.23,0.2,0.23,0.2,0.25,0.27,0.19,0.13,0.1,0.13,-0.03,-0.05,-0.06,-0.05,0.03,0.11,0.08,0.05,0.08,0.11,0.1,0.09,0.09,0.05,-0.01,-0.11,-0.07000000000000001,-0,0.03,0,0.16,0.17,0.2,0.23,0.14,0.04,-0.1,-0.2,-0.27,-0.36,-0.43,-0.47,-0.51,-0.44,-0.43,-0.42,-0.46,-0.57,-0.73,-0.75,-0.91,-0.96,-1.05,-1.2,-1.25,-1.26,-1.15,-1.17,-1.12,-1.09,-1.04,-0.96,-0.88,-0.78,-0.78,-0.6899999999999999,-0.59,-0.47,-0.37,-0.3,-0.2,-0.14,-0.07000000000000001,0.06,0.12,0.24,0.26,0.33,0.31,0.34,0.31,0.33,0.33,0.24,0.3,0.31,0.3,0.28,0.32,0.31,0.29,0.22,0.27,0.16,0.16,0.07000000000000001,0.07000000000000001,0.17,0.18,0.17,0.17,0.07000000000000001,0.02,-0,-0.02,-0.1,-0.1,-0.06,0,-0.04,-0.03,0.05,-0,0.07000000000000001,0.09,0.09,0.03,-0.04,-0.08,-0.12,-0.14,-0.09,-0.05,-0.01,-0.05,-0.07000000000000001,-0.11,-0.13,-0.18,-0.1,-0.1,-0.08,-0.04,-0.01,0.02,0.06,0.12,0.17,0.24,0.23,0.32,0.36,0.39,0.38,0.46,0.51,0.5,0.47,0.38,0.33,0.25,0.18,0.11,0,-0.06,-0.15,-0.24,-0.41,-0.5,-0.51,-0.64,-0.7,-0.8,-0.88,-0.9399999999999999,-1.01,-1.07,-1.13,-1.11,-1.14,-1.12,-1.16,-1.18,-1.13,-1.13,-1.12,-1.09,-1.04,-1.03,-1.02,-0.97,-0.99,-1.01,-1.01,-1,-1.05,-1.09,-1.05,-1.05,-1.05,-1.03,-0.96,-0.99,-0.99,-0.96,-0.86,-0.84,-0.78,-0.74,-0.74,-0.71,-0.63,-0.55,-0.46,-0.48,-0.43,-0.35,-0.27,-0.29,-0.3,-0.28,-0.21,-0.11,-0.13,-0.18,-0.22,-0.23,-0.23,-0.19,-0.18,-0.14,-0.15,-0.13,-0.23,-0.11,-0.04,0.03,0.04,0.04,0.09,0.07000000000000001,0.05,0.08,0.15,0.22,0.27,0.26,0.3,0.3,0.38,0.34,0.37,0.37,0.47,0.41,0.4,0.37,0.33,0.35,0.38,0.43,0.4,0.36,0.35,0.36,0.31,0.37,0.36,0.36,0.43,0.5,0.5,0.5,0.52,0.5,0.49,0.53,0.55,0.58,0.53,0.61,0.74,0.84,0.89,0.9399999999999999,1.07,1.04,1.09,1.08,0.99,0.96,0.99,1.05,1.02,1.09,1.05,1.07,1.06,1.09,1.13,1.11,1.01,0.91,0.88,0.86,0.78,0.83,0.88,0.9399999999999999,0.91,1.02,1.04,1.04,1.03,1.02,1.07,0.97,1.02,1,0.92,0.83,0.77,0.73,0.6899999999999999,0.61,0.51,0.44,0.27,0.21,0.2,0.03,-0.11,-0.24,-0.35,-0.5,-0.58,-0.64,-0.8100000000000001,-0.93,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.76,0.7,0.66,0.61,0.58,0.5600000000000001,0.5,0.47,0.4,0.37,0.35,0.36,0.32,0.3,0.27,0.27,0.25,0.21,0.26,0.23,0.24,0.22,0.17,0.13,0.15,0.14,0.12,0.12,0.08,0.03,-0.03,-0.07000000000000001,-0.1,-0.18,-0.25,-0.29,-0.32,-0.35,-0.36,-0.41,-0.46,-0.45,-0.44,-0.45,-0.47,-0.47,-0.5,-0.5,-0.5,-0.53,-0.53,-0.53,-0.5600000000000001,-0.57,-0.55,-0.54,-0.54,-0.51,-0.47,-0.45,-0.44,-0.41,-0.37,-0.35,-0.32,-0.3,-0.32,-0.32,-0.37,-0.38,-0.42,-0.4,-0.41,-0.4,-0.41,-0.39,-0.38,-0.38,-0.35,-0.32,-0.32,-0.26,-0.19,-0.14,-0.11,-0.08,-0.07000000000000001,-0.06,-0.07000000000000001,-0.03,0.02,0.01,-0,0.02,0.05,0.03,0.03,0.04,0.07000000000000001,0.12,0.15,0.16,0.21,0.23,0.26,0.25,0.26,0.24,0.2,0.18,0.14,0.1,0.08,0.09,0.08,0.09,0.08,0.11,0.13,0.14,0.11,0.05,0.02,-0.01,-0.03,-0.08,-0.11,-0.13,-0.14,-0.15,-0.15,-0.19,-0.26,-0.31,-0.32,-0.37,-0.38,-0.4,-0.42,-0.47,-0.51,-0.49,-0.5,-0.5,-0.52,-0.48,-0.47,-0.46,-0.43,-0.47,-0.47,-0.46,-0.47,-0.49,-0.49,-0.49,-0.47,-0.47,-0.42,-0.41,-0.37,-0.36,-0.36,-0.39,-0.38,-0.42,-0.41,-0.41,-0.43,-0.41,-0.36,-0.3,-0.28,-0.25,-0.22,-0.2,-0.19,-0.16,-0.18,-0.18,-0.17,-0.15,-0.07000000000000001,-0.03,-0.01,0.01,0,0.02,0.05,0.09,0.1,0.12,0.16,0.2,0.2,0.21,0.21,0.2,0.16,0.17,0.14,0.1,0.11,0.09,0.06,0.03,0.02,0.03,0.03,0.02,-0.02,-0.03,-0.02,0,0.03,0.04,0.05,0.05,0.06,0.06,0.04,0.03,0.06,0.06,0.03,0.05,0.08,0.08,0.11,0.14,0.16,0.15,0.1,0.08,0.09,0.08,0.09,0.08,0.06,0.05,0.02,-0.02,-0.08,-0.14,-0.16,-0.2,-0.22,-0.24,-0.27,-0.27,-0.28,-0.3,-0.34,-0.33,-0.32,-0.31,-0.34,-0.37,-0.39,-0.39,-0.4,-0.42,-0.44,-0.48,-0.53,-0.55,-0.59,-0.63,-0.67,-0.68,-0.73,-0.78,-0.82,-0.84,-0.83,-0.85,-0.87,-0.92,-0.9399999999999999,-0.96,-0.95,-0.95,-0.9399999999999999,-0.93,-0.95,-0.93,-0.91,-0.89,-0.85,-0.85,-0.84,-0.82,-0.77,-0.76,-0.74,-0.71,-0.67,-0.65,-0.64,-0.65,-0.63,-0.61,-0.58,-0.5600000000000001,-0.57,-0.54,-0.5,-0.47,-0.49,-0.44,-0.4,-0.38,-0.34,-0.33,-0.3,-0.3,-0.26,-0.21,-0.17,-0.16,-0.11,-0.08,-0.04,-0.03,0,0.01,0.03,0.07000000000000001,0.09,0.1,0.1,0.11,0.11,0.1,0.15,0.16,0.16,0.15,0.15,0.18,0.18,0.21,0.21,0.24,0.3,0.31,0.31,0.32,0.36,0.38,0.39,0.41,0.42,0.42,0.43,0.46,0.51,0.54,0.6,0.6,0.63,0.62,0.63,0.65,0.66,0.67,0.6899999999999999,0.71,0.71,0.72,0.7,0.74,0.72,0.73,0.73,0.77,0.77,0.76,0.76,0.78,0.78,0.8,0.84,0.89,0.87,0.91,0.95,0.98,0.98,0.99,1,0.98,0.99,0.99,0.92,0.9,0.88,0.85,0.83,0.82,0.79,0.76,0.73,0.74,0.74,0.68,0.61,0.55,0.48,0.41,0.34,0.31,0.23,0.19,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.11,0.08,0.05,0.02,0.01,0.01,-0.02,-0.02,-0.03,-0.04,-0.04,-0.02,-0.02,-0.03,-0.02,-0.02,-0.03,-0.06,-0.06,-0.08,-0.09,-0.09,-0.12,-0.14,-0.13,-0.13,-0.13,-0.13,-0.13,-0.15,-0.17,-0.16,-0.14,-0.16,-0.18,-0.19,-0.2,-0.21,-0.21,-0.22,-0.22,-0.22,-0.22,-0.21,-0.21,-0.22,-0.24,-0.23,-0.22,-0.2,-0.19,-0.19,-0.17,-0.17,-0.15,-0.14,-0.14,-0.13,-0.13,-0.13,-0.15,-0.15,-0.15,-0.13,-0.12,-0.11,-0.12,-0.11,-0.12,-0.12,-0.16,-0.18,-0.19,-0.2,-0.22,-0.24,-0.25,-0.26,-0.24,-0.24,-0.23,-0.22,-0.22,-0.22,-0.22,-0.22,-0.23,-0.23,-0.25,-0.25,-0.24,-0.24,-0.25,-0.24,-0.23,-0.23,-0.22,-0.21,-0.18,-0.18,-0.16,-0.15,-0.13,-0.13,-0.11,-0.12,-0.11,-0.11,-0.11,-0.11,-0.11,-0.13,-0.14,-0.15,-0.15,-0.17,-0.16,-0.15,-0.15,-0.14,-0.13,-0.13,-0.13,-0.13,-0.12,-0.14,-0.15,-0.14,-0.16,-0.16,-0.16,-0.17,-0.16,-0.17,-0.17,-0.18,-0.19,-0.19,-0.19,-0.19,-0.2,-0.18,-0.17,-0.15,-0.16,-0.14,-0.13,-0.13,-0.14,-0.15,-0.17,-0.18,-0.18,-0.2,-0.21,-0.23,-0.22,-0.22,-0.2,-0.2,-0.2,-0.19,-0.19,-0.19,-0.18,-0.19,-0.18,-0.18,-0.18,-0.17,-0.16,-0.14,-0.11,-0.1,-0.09,-0.08,-0.06,-0.04,-0.03,-0.02,-0.01,-0,0.02,0.03,0.04,0.04,0.05,0.05,0.06,0.07000000000000001,0.06,0.05,0.04,0.03,0.02,0.01,-0.01,-0.02,-0.05,-0.05,-0.07000000000000001,-0.1,-0.11,-0.12,-0.13,-0.14,-0.16,-0.17,-0.18,-0.18,-0.21,-0.22,-0.23,-0.24,-0.25,-0.25,-0.27,-0.29,-0.3,-0.31,-0.34,-0.37,-0.38,-0.39,-0.4,-0.4,-0.4,-0.42,-0.41,-0.41,-0.4,-0.4,-0.42,-0.42,-0.43,-0.43,-0.41,-0.4,-0.4,-0.4,-0.41,-0.42,-0.42,-0.45,-0.45,-0.45,-0.45,-0.44,-0.45,-0.46,-0.46,-0.46,-0.46,-0.44,-0.44,-0.43,-0.42,-0.42,-0.44,-0.42,-0.4,-0.4,-0.39,-0.4,-0.41,-0.42,-0.42,-0.42,-0.42,-0.42,-0.42,-0.43,-0.43,-0.43,-0.41,-0.42,-0.42,-0.42,-0.42,-0.43,-0.42,-0.42,-0.42,-0.41,-0.4,-0.39,-0.38,-0.37,-0.35,-0.34,-0.33,-0.31,-0.28,-0.26,-0.22,-0.2,-0.18,-0.17,-0.14,-0.14,-0.12,-0.1,-0.08,-0.07000000000000001,-0.07000000000000001,-0.04,0,0.03,0.05,0.08,0.11,0.12,0.15,0.16,0.18,0.19,0.22,0.25,0.27,0.28,0.3,0.33,0.34,0.35,0.37,0.39,0.4,0.42,0.43,0.44,0.44,0.45,0.48,0.5,0.51,0.53,0.55,0.57,0.57,0.58,0.59,0.6,0.6,0.61,0.61,0.61,0.59,0.59,0.59,0.6,0.59,0.59,0.58,0.58,0.58,0.57,0.5600000000000001,0.54,0.54,0.5,0.49,0.46,0.43,0.42,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,0.91,0.86,0.84,0.84,0.87,0.93,1,1.07,1.13,1.17,1.18,1.17,1.14,1.08,1.01,0.9399999999999999,0.88,0.84,0.82,0.8100000000000001,0.82,0.84,0.86,0.86,0.82,0.75,0.64,0.52,0.39,0.26,0.13,0.02,-0.08,-0.15,-0.19,-0.22,-0.24,-0.25,-0.27,-0.29,-0.34,-0.4,-0.46,-0.51,-0.54,-0.5600000000000001,-0.57,-0.57,-0.55,-0.51,-0.44,-0.35,-0.23,-0.1,0.03,0.16,0.28,0.38,0.45,0.49,0.49,0.44,0.34,0.18,-0.01,-0.23,-0.47,-0.6899999999999999,-0.89,-1.06,-1.19,-1.28,-1.33,-1.33,-1.3,-1.25,-1.18,-1.1,-1.03,-0.96,-0.91,-0.87,-0.84,-0.8100000000000001,-0.79,-0.77,-0.75,-0.73,-0.7,-0.67,-0.63,-0.5600000000000001,-0.47,-0.35,-0.21,-0.05,0.12,0.28,0.41,0.51,0.57,0.58,0.55,0.5,0.43,0.35,0.28,0.23,0.2,0.19,0.2,0.23,0.25,0.27,0.29,0.31,0.31,0.31,0.3,0.29,0.27,0.24,0.22,0.18,0.14,0.1,0.04,-0.03,-0.1,-0.16,-0.21,-0.23,-0.22,-0.18,-0.12,-0.03,0.07000000000000001,0.18,0.28,0.36,0.4,0.38,0.33,0.23,0.11,-0.01,-0.12,-0.2,-0.23,-0.22,-0.18,-0.1,-0.03,0.03,0.06,0.04,-0.03,-0.14,-0.29,-0.46,-0.62,-0.76,-0.87,-0.9399999999999999,-0.99,-1.02,-1.03,-1.05,-1.06,-1.1,-1.15,-1.21,-1.26,-1.31,-1.34,-1.34,-1.32,-1.25,-1.16,-1.03,-0.87,-0.7,-0.52,-0.33,-0.14,0.03,0.17,0.29,0.37,0.42,0.44,0.44,0.42,0.4,0.37,0.34,0.31,0.28,0.25,0.22,0.2,0.18,0.18,0.19,0.21,0.24,0.28,0.32,0.35,0.36,0.35,0.31,0.24,0.17,0.09,0.03,-0.02,-0.05,-0.08,-0.1,-0.11,-0.13,-0.14,-0.15,-0.15,-0.14,-0.11,-0.06,-0.01,0.05,0.12,0.19,0.23,0.25,0.23,0.18,0.1,0,-0.1,-0.2,-0.28,-0.33,-0.37,-0.38,-0.38,-0.35,-0.29,-0.22,-0.12,-0.02,0.09,0.19,0.29,0.37,0.45,0.5,0.54,0.5600000000000001,0.55,0.54,0.51,0.49,0.47,0.45,0.43,0.4,0.35,0.29,0.2,0.1,-0.02,-0.15,-0.29,-0.44,-0.6,-0.74,-0.88,-1,-1.1,-1.18,-1.24,-1.28,-1.3,-1.29,-1.28,-1.24,-1.2,-1.15,-1.11,-1.07,-1.04,-1.01,-0.99,-0.98,-0.97,-0.96,-0.96,-0.95,-0.96,-0.97,-0.98,-1,-1.03,-1.05,-1.08,-1.11,-1.13,-1.14,-1.12,-1.1,-1.06,-1,-0.93,-0.84,-0.74,-0.64,-0.55,-0.47,-0.39,-0.33,-0.28,-0.23,-0.2,-0.18,-0.17,-0.17,-0.18,-0.19,-0.2,-0.2,-0.19,-0.19,-0.2,-0.2,-0.21,-0.21,-0.2,-0.2,-0.19,-0.18,-0.16,-0.14,-0.09,-0.04,0.03,0.11,0.18,0.23,0.27,0.29,0.31,0.32,0.33,0.34,0.34,0.35,0.35,0.36,0.37,0.39,0.41,0.43,0.44,0.44,0.44,0.43,0.42,0.41,0.39,0.36,0.34,0.32,0.3,0.28,0.28,0.28,0.31,0.36,0.42,0.49,0.5600000000000001,0.63,0.6899999999999999,0.73,0.76,0.77,0.75,0.73,0.72,0.73,0.76,0.82,0.91,1.02,1.14,1.24,1.31,1.35,1.35,1.32,1.27,1.2,1.11,1.03,0.96,0.9,0.86,0.84,0.82,0.8100000000000001,0.8,0.78,0.78,0.78,0.79,0.83,0.88,0.9399999999999999,1.01,1.09,1.16,1.22,1.27,1.28,1.27,1.22,1.14,1.02,0.87,0.7,0.53,0.35,0.19,0.03,-0.11,-0.22,-0.31,-0.37,-0.43,-0.47,-0.52,-0.57,-0.63,-0.71,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.88,0.86,0.83,0.8,0.76,0.72,0.68,0.64,0.6,0.55,0.5,0.44,0.39,0.33,0.28,0.22,0.16,0.11,0.06,0.01,-0.04,-0.08,-0.12,-0.15,-0.18,-0.2,-0.22,-0.23,-0.24,-0.24,-0.24,-0.23,-0.22,-0.21,-0.2,-0.18,-0.17,-0.17,-0.16,-0.16,-0.17,-0.17,-0.19,-0.2,-0.22,-0.25,-0.28,-0.31,-0.34,-0.38,-0.42,-0.46,-0.51,-0.55,-0.59,-0.64,-0.68,-0.72,-0.76,-0.79,-0.8100000000000001,-0.84,-0.85,-0.86,-0.85,-0.84,-0.82,-0.8,-0.76,-0.72,-0.67,-0.62,-0.57,-0.52,-0.46,-0.4,-0.34,-0.28,-0.23,-0.18,-0.12,-0.08,-0.03,0.01,0.05,0.09,0.13,0.16,0.19,0.21,0.23,0.25,0.26,0.27,0.28,0.28,0.28,0.28,0.27,0.25,0.24,0.22,0.21,0.19,0.17,0.16,0.14,0.13,0.12,0.12,0.11,0.1,0.1,0.09,0.08,0.08,0.07000000000000001,0.06,0.06,0.05,0.05,0.05,0.04,0.04,0.04,0.03,0.03,0.02,0.01,-0,-0.02,-0.03,-0.05,-0.08,-0.1,-0.13,-0.17,-0.2,-0.24,-0.29,-0.33,-0.38,-0.43,-0.48,-0.54,-0.59,-0.64,-0.68,-0.73,-0.77,-0.8,-0.83,-0.86,-0.88,-0.89,-0.89,-0.89,-0.89,-0.87,-0.85,-0.82,-0.78,-0.74,-0.6899999999999999,-0.64,-0.58,-0.52,-0.46,-0.4,-0.34,-0.27,-0.22,-0.16,-0.1,-0.05,0,0.05,0.09,0.13,0.17,0.2,0.22,0.24,0.25,0.26,0.26,0.26,0.26,0.25,0.24,0.23,0.21,0.2,0.18,0.17,0.15,0.14,0.12,0.11,0.1,0.09,0.08,0.07000000000000001,0.06,0.05,0.05,0.04,0.03,0.02,0.01,0.01,-0,-0.01,-0.02,-0.03,-0.04,-0.04,-0.05,-0.05,-0.05,-0.06,-0.05,-0.05,-0.05,-0.04,-0.04,-0.03,-0.02,-0.01,0.01,0.02,0.04,0.06,0.08,0.1,0.12,0.14,0.16,0.18,0.2,0.21,0.22,0.23,0.23,0.23,0.22,0.2,0.18,0.15,0.11,0.07000000000000001,0.02,-0.03,-0.09,-0.15,-0.22,-0.28,-0.35,-0.42,-0.48,-0.55,-0.61,-0.67,-0.73,-0.78,-0.83,-0.87,-0.91,-0.9399999999999999,-0.97,-1,-1.02,-1.04,-1.05,-1.06,-1.07,-1.07,-1.07,-1.07,-1.07,-1.06,-1.06,-1.05,-1.04,-1.03,-1.02,-1,-0.99,-0.97,-0.95,-0.93,-0.91,-0.89,-0.86,-0.84,-0.8100000000000001,-0.78,-0.75,-0.71,-0.68,-0.65,-0.61,-0.58,-0.54,-0.51,-0.47,-0.44,-0.41,-0.38,-0.35,-0.32,-0.3,-0.27,-0.25,-0.23,-0.21,-0.19,-0.17,-0.15,-0.14,-0.12,-0.1,-0.08,-0.07000000000000001,-0.05,-0.03,-0.01,0.02,0.04,0.06,0.09,0.11,0.13,0.16,0.18,0.2,0.22,0.25,0.26,0.28,0.3,0.31,0.32,0.33,0.34,0.35,0.36,0.36,0.37,0.38,0.38,0.39,0.39,0.4,0.41,0.42,0.42,0.43,0.44,0.46,0.47,0.49,0.51,0.53,0.5600000000000001,0.58,0.61,0.64,0.67,0.7,0.73,0.76,0.79,0.82,0.85,0.87,0.9,0.92,0.9399999999999999,0.95,0.97,0.98,0.99,0.99,1,1,1,1,1,1,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.98,0.98,0.97,0.96,0.9399999999999999,0.93,0.91,0.89,0.86,0.84,0.8100000000000001,0.77,0.73,0.6899999999999999,0.64,0.58,0.52,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.05,0.02,-0,-0.03,-0.05,-0.08,-0.1,-0.13,-0.15,-0.18,-0.2,-0.22,-0.24,-0.26,-0.28,-0.3,-0.32,-0.33,-0.35,-0.36,-0.38,-0.39,-0.4,-0.41,-0.42,-0.43,-0.43,-0.44,-0.44,-0.44,-0.45,-0.45,-0.44,-0.44,-0.44,-0.44,-0.43,-0.43,-0.42,-0.41,-0.4,-0.39,-0.38,-0.37,-0.36,-0.35,-0.34,-0.33,-0.31,-0.3,-0.29,-0.27,-0.26,-0.24,-0.23,-0.21,-0.2,-0.18,-0.17,-0.15,-0.13,-0.12,-0.1,-0.08,-0.07000000000000001,-0.05,-0.04,-0.02,-0.01,0.01,0.02,0.03,0.04,0.06,0.07000000000000001,0.07000000000000001,0.08,0.09,0.09,0.1,0.1,0.1,0.1,0.1,0.1,0.09,0.09,0.08,0.07000000000000001,0.06,0.05,0.04,0.03,0.02,0,-0.01,-0.03,-0.05,-0.06,-0.08,-0.1,-0.12,-0.14,-0.16,-0.18,-0.19,-0.21,-0.23,-0.25,-0.26,-0.28,-0.3,-0.31,-0.33,-0.34,-0.35,-0.36,-0.38,-0.39,-0.4,-0.4,-0.41,-0.42,-0.42,-0.43,-0.43,-0.43,-0.43,-0.43,-0.43,-0.43,-0.42,-0.42,-0.41,-0.4,-0.4,-0.39,-0.38,-0.37,-0.36,-0.35,-0.33,-0.32,-0.31,-0.29,-0.28,-0.26,-0.25,-0.23,-0.21,-0.2,-0.18,-0.16,-0.15,-0.13,-0.11,-0.1,-0.08,-0.07000000000000001,-0.05,-0.04,-0.03,-0.02,-0,0.01,0.02,0.03,0.03,0.04,0.05,0.05,0.06,0.06,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.05,0.05,0.05,0.05,0.04,0.04,0.04,0.03,0.03,0.02,0.02,0.01,0,-0.01,-0.02,-0.03,-0.04,-0.05,-0.06,-0.08,-0.09,-0.1,-0.12,-0.14,-0.15,-0.17,-0.19,-0.21,-0.23,-0.25,-0.27,-0.29,-0.31,-0.34,-0.36,-0.38,-0.4,-0.43,-0.45,-0.47,-0.5,-0.52,-0.54,-0.5600000000000001,-0.58,-0.6,-0.62,-0.64,-0.66,-0.68,-0.6899999999999999,-0.71,-0.72,-0.74,-0.75,-0.76,-0.77,-0.78,-0.79,-0.79,-0.8,-0.8,-0.8,-0.8,-0.8,-0.79,-0.79,-0.78,-0.78,-0.77,-0.76,-0.74,-0.73,-0.72,-0.7,-0.68,-0.67,-0.65,-0.63,-0.61,-0.59,-0.57,-0.54,-0.52,-0.5,-0.47,-0.45,-0.43,-0.4,-0.38,-0.36,-0.33,-0.31,-0.29,-0.26,-0.24,-0.22,-0.2,-0.17,-0.15,-0.13,-0.11,-0.09,-0.07000000000000001,-0.05,-0.03,-0.01,0.01,0.03,0.05,0.07000000000000001,0.09,0.11,0.13,0.14,0.16,0.18,0.19,0.21,0.23,0.25,0.26,0.28,0.3,0.31,0.33,0.35,0.36,0.38,0.4,0.41,0.43,0.45,0.46,0.48,0.49,0.51,0.53,0.54,0.5600000000000001,0.57,0.59,0.6,0.62,0.63,0.65,0.66,0.68,0.6899999999999999,0.71,0.72,0.73,0.75,0.76,0.77,0.78,0.79,0.8,0.8100000000000001,0.8100000000000001,0.82,0.83,0.83,0.83,0.83,0.84,0.83,0.83,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>yrs<\/th>\n      <th>Z<\/th>\n      <th>ma20<\/th>\n      <th>ma50<\/th>\n      <th>ma100<\/th>\n      <th>han20<\/th>\n      <th>han50<\/th>\n      <th>han100<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":75,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"yrs","targets":1},{"name":"Z","targets":2},{"name":"ma20","targets":3},{"name":"ma50","targets":4},{"name":"ma100","targets":5},{"name":"han20","targets":6},{"name":"han50","targets":7},{"name":"han100","targets":8}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,25,50,75,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="smoothing-splines" class="section level3 hasAnchor" number="11.3.3">
<h3><span class="header-section-number">11.3.3</span> Smoothing splines<a href="filtering-smoothing.html#smoothing-splines" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The function <code>smooth.spline()</code> fits a smooth curve to a set of observations using piecewise polynomials. Splines are used very commonly in time-series work both for smoothing and interpolating. We will look at interpolation below. The <code>spar</code> parameter is the one you can play with in <code>smooth.spline()</code>. Larger numbers smooth the data more heavily. Sadly the <code>spar</code> doesn’t translate into time units very easily.</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="filtering-smoothing.html#cb295-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> </span>
<span id="cb295-2"><a href="filtering-smoothing.html#cb295-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ss0.2 =</span> <span class="fu">smooth.spline</span>(Z,<span class="at">spar=</span><span class="fl">0.2</span>)<span class="sc">$</span>y,</span>
<span id="cb295-3"><a href="filtering-smoothing.html#cb295-3" tabindex="-1"></a>         <span class="at">ss0.4 =</span> <span class="fu">smooth.spline</span>(Z,<span class="at">spar=</span><span class="fl">0.4</span>)<span class="sc">$</span>y,</span>
<span id="cb295-4"><a href="filtering-smoothing.html#cb295-4" tabindex="-1"></a>         <span class="at">ss0.6 =</span> <span class="fu">smooth.spline</span>(Z,<span class="at">spar=</span><span class="fl">0.6</span>)<span class="sc">$</span>y)</span>
<span id="cb295-5"><a href="filtering-smoothing.html#cb295-5" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Smoothing Spline Filters&quot;</span>) <span class="sc">+</span></span>
<span id="cb295-6"><a href="filtering-smoothing.html#cb295-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>dat, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>yrs,<span class="at">y=</span>ss0<span class="fl">.2</span>), <span class="at">color =</span> sfPal[<span class="dv">1</span>],<span class="at">linewidth=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb295-7"><a href="filtering-smoothing.html#cb295-7" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>dat, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>yrs,<span class="at">y=</span>ss0<span class="fl">.4</span>), <span class="at">color =</span> sfPal[<span class="dv">2</span>],<span class="at">linewidth=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb295-8"><a href="filtering-smoothing.html#cb295-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>dat, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>yrs,<span class="at">y=</span>ss0<span class="fl">.6</span>), <span class="at">color =</span> sfPal[<span class="dv">3</span>],<span class="at">linewidth=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="08TimeSeries-Filters_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="loess" class="section level3 hasAnchor" number="11.3.4">
<h3><span class="header-section-number">11.3.4</span> Loess<a href="filtering-smoothing.html#loess" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I’ve become increasingly fond of the loess smoother which uses a local, linear polynomial fit to smooth data. The parameter to adjust is the span <code>span</code>. Because <code>span</code> is the proportion of points used in the smoothing, the smaller the number the stiffer the curve will be. So a <code>span</code> of 0.05 would use 5% of the points. We can make the curves similar to the number of years in our moving average or hanning filters with some division.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="filtering-smoothing.html#cb296-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> </span>
<span id="cb296-2"><a href="filtering-smoothing.html#cb296-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">f20.lo =</span> <span class="fu">loess</span>(Z<span class="sc">~</span>yrs, <span class="at">span =</span> <span class="dv">20</span><span class="sc">/</span>nyrs)<span class="sc">$</span>fitted,</span>
<span id="cb296-3"><a href="filtering-smoothing.html#cb296-3" tabindex="-1"></a>         <span class="at">f50.lo =</span> <span class="fu">loess</span>(Z<span class="sc">~</span>yrs, <span class="at">span =</span> <span class="dv">50</span><span class="sc">/</span>nyrs)<span class="sc">$</span>fitted,</span>
<span id="cb296-4"><a href="filtering-smoothing.html#cb296-4" tabindex="-1"></a>         <span class="at">f100.lo =</span> <span class="fu">loess</span>(Z<span class="sc">~</span>yrs, <span class="at">span =</span> <span class="dv">100</span><span class="sc">/</span>nyrs)<span class="sc">$</span>fitted)</span>
<span id="cb296-5"><a href="filtering-smoothing.html#cb296-5" tabindex="-1"></a></span>
<span id="cb296-6"><a href="filtering-smoothing.html#cb296-6" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Loess Filters&quot;</span>) <span class="sc">+</span></span>
<span id="cb296-7"><a href="filtering-smoothing.html#cb296-7" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>dat, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>yrs,<span class="at">y=</span>f20.lo), <span class="at">color =</span> sfPal[<span class="dv">1</span>],<span class="at">linewidth=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb296-8"><a href="filtering-smoothing.html#cb296-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>dat, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>yrs,<span class="at">y=</span>f50.lo), <span class="at">color =</span> sfPal[<span class="dv">2</span>],<span class="at">linewidth=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb296-9"><a href="filtering-smoothing.html#cb296-9" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>dat, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>yrs,<span class="at">y=</span>f100.lo), <span class="at">color =</span> sfPal[<span class="dv">3</span>],<span class="at">linewidth=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="08TimeSeries-Filters_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Unlike the moving averages and hanning filters, the smooth is the same length as the input data. That’s nice…but preserving the ends of the data means that there is less information at play on the ends than there is in the middle. There is no way to model the ends members to everybody’s satisfaction.</p>
<p>Let’s look at <code>dat</code> again.</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="filtering-smoothing.html#cb297-1" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="fu">round</span>(dat,<span class="dv">2</span>),<span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">75</span>))</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-c71d2211b8ac3760336f" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c71d2211b8ac3760336f">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463"],[1530,1531,1532,1533,1534,1535,1536,1537,1538,1539,1540,1541,1542,1543,1544,1545,1546,1547,1548,1549,1550,1551,1552,1553,1554,1555,1556,1557,1558,1559,1560,1561,1562,1563,1564,1565,1566,1567,1568,1569,1570,1571,1572,1573,1574,1575,1576,1577,1578,1579,1580,1581,1582,1583,1584,1585,1586,1587,1588,1589,1590,1591,1592,1593,1594,1595,1596,1597,1598,1599,1600,1601,1602,1603,1604,1605,1606,1607,1608,1609,1610,1611,1612,1613,1614,1615,1616,1617,1618,1619,1620,1621,1622,1623,1624,1625,1626,1627,1628,1629,1630,1631,1632,1633,1634,1635,1636,1637,1638,1639,1640,1641,1642,1643,1644,1645,1646,1647,1648,1649,1650,1651,1652,1653,1654,1655,1656,1657,1658,1659,1660,1661,1662,1663,1664,1665,1666,1667,1668,1669,1670,1671,1672,1673,1674,1675,1676,1677,1678,1679,1680,1681,1682,1683,1684,1685,1686,1687,1688,1689,1690,1691,1692,1693,1694,1695,1696,1697,1698,1699,1700,1701,1702,1703,1704,1705,1706,1707,1708,1709,1710,1711,1712,1713,1714,1715,1716,1717,1718,1719,1720,1721,1722,1723,1724,1725,1726,1727,1728,1729,1730,1731,1732,1733,1734,1735,1736,1737,1738,1739,1740,1741,1742,1743,1744,1745,1746,1747,1748,1749,1750,1751,1752,1753,1754,1755,1756,1757,1758,1759,1760,1761,1762,1763,1764,1765,1766,1767,1768,1769,1770,1771,1772,1773,1774,1775,1776,1777,1778,1779,1780,1781,1782,1783,1784,1785,1786,1787,1788,1789,1790,1791,1792,1793,1794,1795,1796,1797,1798,1799,1800,1801,1802,1803,1804,1805,1806,1807,1808,1809,1810,1811,1812,1813,1814,1815,1816,1817,1818,1819,1820,1821,1822,1823,1824,1825,1826,1827,1828,1829,1830,1831,1832,1833,1834,1835,1836,1837,1838,1839,1840,1841,1842,1843,1844,1845,1846,1847,1848,1849,1850,1851,1852,1853,1854,1855,1856,1857,1858,1859,1860,1861,1862,1863,1864,1865,1866,1867,1868,1869,1870,1871,1872,1873,1874,1875,1876,1877,1878,1879,1880,1881,1882,1883,1884,1885,1886,1887,1888,1889,1890,1891,1892,1893,1894,1895,1896,1897,1898,1899,1900,1901,1902,1903,1904,1905,1906,1907,1908,1909,1910,1911,1912,1913,1914,1915,1916,1917,1918,1919,1920,1921,1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992],[[2.69],[1.17],[2.25],[0.74],[0.63],[2.47],[0.2],[2.04],[0.74],[1.28],[0.09],[1.17],[0.74],[-0.13],[0.09],[1.61],[1.71],[-0.13],[2.04],[1.39],[0.96],[2.69],[2.25],[-0.35],[0.8100000000000001],[0.45],[0.18],[0.48],[1.39],[1.76],[0.31],[-0.88],[1.7],[2.25],[1.17],[0.31],[0.74],[0.23],[1.18],[0.73],[-0.68],[-1.27],[-0.73],[0.09],[-0.44],[0.8100000000000001],[-0.5600000000000001],[-0.5600000000000001],[-0.07000000000000001],[0.09],[-0.28],[-0.5600000000000001],[-0.13],[-1.21],[-0.12],[-0.77],[-1.32],[-1.21],[-0.5600000000000001],[0.13],[0.63],[-0.78],[-0.53],[-1.32],[-0.13],[0.71],[-0.41],[2.47],[0.2],[2.25],[-0.13],[0.39],[-0.13],[0.7],[0.48],[-0.62],[0.17],[-1.38],[-1.24],[-1.07],[-1.99],[-2.2],[-2.27],[-1.37],[-0.9],[-0.96],[-0.78],[-0.47],[-1.31],[-1.55],[-0.47],[-0.59],[-1.21],[-0.9399999999999999],[-0.64],[-0.6],[-0.28],[-0.97],[-1.14],[-0.17],[-0.26],[-1.91],[-0.58],[-0.48],[0.49],[-0.97],[0.6],[0.58],[0.24],[1.08],[2.12],[0.85],[0.46],[0.42],[0.66],[0.06],[-0.87],[0.11],[-0.44],[0.51],[0.74],[-0.13],[0.63],[-0.02],[1.39],[-0.14],[0.26],[0.19],[0.08],[-0.6899999999999999],[1.03],[1.26],[0.12],[0.06],[0.42],[-0.49],[-0.2],[-0.67],[0.7],[0.88],[-0.92],[-1.28],[0.05],[0.48],[-1.82],[-0.51],[0.09],[0.43],[1.56],[1.06],[0.43],[0.67],[0.5600000000000001],[0.71],[0.29],[-0.71],[-0.17],[-1.5],[-0.6],[-0.95],[-0.2],[0.03],[0.75],[-0.14],[1.29],[-0.2],[0.66],[1.12],[-0.37],[-0.92],[-2.23],[-1.35],[-1.01],[-1.02],[-1.12],[-1.46],[-1],[-0.17],[-0.32],[-0.77],[-1.01],[-2.23],[-2.27],[-0.66],[-1.77],[-1.2],[-1.29],[-1.83],[-1.46],[-1.05],[-0.05],[-1.68],[-0.13],[-0.29],[-0.19],[0.15],[0.66],[1.86],[-0.46],[1.05],[1.02],[0.16],[-0.31],[0.76],[0.29],[0.08],[-0.01],[0.86],[-0.31],[1.25],[0.45],[-0.27],[-0.47],[0.23],[-0.73],[0.46],[0.62],[0.22],[0.66],[1.17],[0.85],[-0.23],[0.45],[0.68],[-0.23],[-1.21],[0.95],[-1.33],[-0.38],[-0.52],[0.41],[1.83],[-0.35],[0.02],[-0.66],[-1.56],[-0.33],[-0.21],[0.22],[-0.36],[0.88],[0.57],[1.65],[-0.22],[0.12],[0.3],[-0.11],[0.04],[0.19],[-0.59],[-0.79],[0.39],[-1.17],[-0.7],[-1.11],[-0.48],[0.46],[0.57],[-0.59],[-0.74],[0.1],[0.05],[0.65],[1.41],[0.22],[0.5600000000000001],[0.67],[0.78],[0.77],[0.18],[0.37],[1.33],[0.27],[-0.84],[0.71],[0.34],[1.02],[0.27],[1.1],[0.25],[-0.19],[-0.5600000000000001],[-1.02],[0.28],[-1.24],[-1.02],[-0.64],[-1.4],[-0.39],[-1.6],[-1.46],[-2.11],[-1.57],[-1.09],[-1.7],[-0.99],[-0.87],[-1.38],[-0.21],[-0.99],[-1.55],[-1.63],[-0.5600000000000001],[-0.36],[-0.79],[-1.97],[-0.92],[-0.46],[-0.46],[-1.33],[-0.76],[-1.18],[-1.34],[-0.9399999999999999],[-0.6899999999999999],[-1.45],[-1.31],[-1.31],[-0.06],[-1.88],[-2.34],[-0.87],[-0.59],[-0.39],[-0.42],[-0.45],[-1.63],[-0.35],[0.11],[0.57],[-0.26],[-0.09],[-0.43],[-0.9399999999999999],[-0.14],[0.19],[0.2],[0.54],[-0.4],[-0.82],[-0.76],[0.61],[-1],[-0.47],[0],[0.93],[0.22],[-0.68],[-0.87],[-0.26],[-0.49],[-0.02],[0.26],[-0.6],[0.52],[0.1],[0.52],[-1.31],[1.87],[0.6899999999999999],[0.53],[0.8100000000000001],[-0.91],[0.48],[-0.46],[0.49],[0.88],[0.67],[0.66],[0.6],[-0.66],[0.74],[0.32],[1.09],[-0.35],[0.6899999999999999],[0.65],[0.66],[0.58],[0.5600000000000001],[-0.02],[0.02],[-0.6899999999999999],[1.12],[0.5600000000000001],[-0.04],[0.04],[0.53],[0.76],[-0.36],[0.63],[0.36],[0.48],[2.5],[0.89],[0.84],[0.5],[1.2],[0.15],[0.24],[0.9399999999999999],[0.3],[0.01],[0.15],[2.02],[2.63],[2.1],[1.46],[1.75],[2.23],[0.12],[1.29],[0.32],[0.62],[0.34],[1.39],[1.79],[0.63],[1.52],[-0.5600000000000001],[1.38],[-0.08],[0.75],[0.89],[1.54],[0.78],[0.1],[0.7],[1.54],[0.59],[1.05],[2.23],[1.53],[0.15],[2.52],[1.84],[1.7],[0.5],[1.19],[0.48],[-0.66],[0.91],[0.45],[-0.84],[-0.22],[-0.29],[-0.74],[-0.09],[-0.19],[-1.32],[-0.45],[-1.1],[0.34],[-0.06],[-0.92],[-0.92],[-0.87],[-1.64],[-1.81],[-1.26],[-1.71],[-2.52],[-1.9]],[null,null,null,null,null,null,null,null,null,1.14,1.05,1.13,1.13,1.07,1.08,0.98,0.98,0.9,0.9399999999999999,0.96,0.97,0.87,0.92,1.04,1.09,1.02,0.98,0.99,0.95,0.92,0.84,0.64,0.49,0.51,0.45,0.47,0.43,0.38,0.3,0.22,0.19,0.21,0.12,-0.06,-0.12,-0.18,-0.28,-0.35,-0.44,-0.47,-0.4,-0.38,-0.37,-0.44,-0.42,-0.43,-0.42,-0.27,-0.25,-0.15,-0.14,-0.09,-0.09,0,0.03,0.04,0.12,0.11,0.07000000000000001,0.01,-0.12,-0.19,-0.28,-0.28,-0.32,-0.4,-0.42,-0.57,-0.64,-0.83,-0.85,-0.9,-0.95,-1.03,-1.09,-1.09,-1.11,-1.09,-1.09,-1.04,-0.95,-0.9399999999999999,-0.86,-0.8100000000000001,-0.74,-0.74,-0.67,-0.62,-0.54,-0.41,-0.28,-0.21,-0.13,-0.06,0.01,0.04,0.01,0.07000000000000001,0.1,0.13,0.18,0.27,0.33,0.36,0.4,0.44,0.43,0.41,0.4,0.31,0.26,0.28,0.26,0.24,0.23,0.2,0.23,0.2,0.25,0.27,0.19,0.13,0.1,0.13,-0.03,-0.05,-0.06,-0.05,0.03,0.11,0.08,0.05,0.08,0.11,0.1,0.09,0.09,0.05,-0.01,-0.11,-0.07000000000000001,-0,0.03,0,0.16,0.17,0.2,0.23,0.14,0.04,-0.1,-0.2,-0.27,-0.36,-0.43,-0.47,-0.51,-0.44,-0.43,-0.42,-0.46,-0.57,-0.73,-0.75,-0.91,-0.96,-1.05,-1.2,-1.25,-1.26,-1.15,-1.17,-1.12,-1.09,-1.04,-0.96,-0.88,-0.78,-0.78,-0.6899999999999999,-0.59,-0.47,-0.37,-0.3,-0.2,-0.14,-0.07000000000000001,0.06,0.12,0.24,0.26,0.33,0.31,0.34,0.31,0.33,0.33,0.24,0.3,0.31,0.3,0.28,0.32,0.31,0.29,0.22,0.27,0.16,0.16,0.07000000000000001,0.07000000000000001,0.17,0.18,0.17,0.17,0.07000000000000001,0.02,-0,-0.02,-0.1,-0.1,-0.06,0,-0.04,-0.03,0.05,-0,0.07000000000000001,0.09,0.09,0.03,-0.04,-0.08,-0.12,-0.14,-0.09,-0.05,-0.01,-0.05,-0.07000000000000001,-0.11,-0.13,-0.18,-0.1,-0.1,-0.08,-0.04,-0.01,0.02,0.06,0.12,0.17,0.24,0.23,0.32,0.36,0.39,0.38,0.46,0.51,0.5,0.47,0.38,0.33,0.25,0.18,0.11,0,-0.06,-0.15,-0.24,-0.41,-0.5,-0.51,-0.64,-0.7,-0.8,-0.88,-0.9399999999999999,-1.01,-1.07,-1.13,-1.11,-1.14,-1.12,-1.16,-1.18,-1.13,-1.13,-1.12,-1.09,-1.04,-1.03,-1.02,-0.97,-0.99,-1.01,-1.01,-1,-1.05,-1.09,-1.05,-1.05,-1.05,-1.03,-0.96,-0.99,-0.99,-0.96,-0.86,-0.84,-0.78,-0.74,-0.74,-0.71,-0.63,-0.55,-0.46,-0.48,-0.43,-0.35,-0.27,-0.29,-0.3,-0.28,-0.21,-0.11,-0.13,-0.18,-0.22,-0.23,-0.23,-0.19,-0.18,-0.14,-0.15,-0.13,-0.23,-0.11,-0.04,0.03,0.04,0.04,0.09,0.07000000000000001,0.05,0.08,0.15,0.22,0.27,0.26,0.3,0.3,0.38,0.34,0.37,0.37,0.47,0.41,0.4,0.37,0.33,0.35,0.38,0.43,0.4,0.36,0.35,0.36,0.31,0.37,0.36,0.36,0.43,0.5,0.5,0.5,0.52,0.5,0.49,0.53,0.55,0.58,0.53,0.61,0.74,0.84,0.89,0.9399999999999999,1.07,1.04,1.09,1.08,0.99,0.96,0.99,1.05,1.02,1.09,1.05,1.07,1.06,1.09,1.13,1.11,1.01,0.91,0.88,0.86,0.78,0.83,0.88,0.9399999999999999,0.91,1.02,1.04,1.04,1.03,1.02,1.07,0.97,1.02,1,0.92,0.83,0.77,0.73,0.6899999999999999,0.61,0.51,0.44,0.27,0.21,0.2,0.03,-0.11,-0.24,-0.35,-0.5,-0.58,-0.64,-0.8100000000000001,-0.93,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.76,0.7,0.66,0.61,0.58,0.5600000000000001,0.5,0.47,0.4,0.37,0.35,0.36,0.32,0.3,0.27,0.27,0.25,0.21,0.26,0.23,0.24,0.22,0.17,0.13,0.15,0.14,0.12,0.12,0.08,0.03,-0.03,-0.07000000000000001,-0.1,-0.18,-0.25,-0.29,-0.32,-0.35,-0.36,-0.41,-0.46,-0.45,-0.44,-0.45,-0.47,-0.47,-0.5,-0.5,-0.5,-0.53,-0.53,-0.53,-0.5600000000000001,-0.57,-0.55,-0.54,-0.54,-0.51,-0.47,-0.45,-0.44,-0.41,-0.37,-0.35,-0.32,-0.3,-0.32,-0.32,-0.37,-0.38,-0.42,-0.4,-0.41,-0.4,-0.41,-0.39,-0.38,-0.38,-0.35,-0.32,-0.32,-0.26,-0.19,-0.14,-0.11,-0.08,-0.07000000000000001,-0.06,-0.07000000000000001,-0.03,0.02,0.01,-0,0.02,0.05,0.03,0.03,0.04,0.07000000000000001,0.12,0.15,0.16,0.21,0.23,0.26,0.25,0.26,0.24,0.2,0.18,0.14,0.1,0.08,0.09,0.08,0.09,0.08,0.11,0.13,0.14,0.11,0.05,0.02,-0.01,-0.03,-0.08,-0.11,-0.13,-0.14,-0.15,-0.15,-0.19,-0.26,-0.31,-0.32,-0.37,-0.38,-0.4,-0.42,-0.47,-0.51,-0.49,-0.5,-0.5,-0.52,-0.48,-0.47,-0.46,-0.43,-0.47,-0.47,-0.46,-0.47,-0.49,-0.49,-0.49,-0.47,-0.47,-0.42,-0.41,-0.37,-0.36,-0.36,-0.39,-0.38,-0.42,-0.41,-0.41,-0.43,-0.41,-0.36,-0.3,-0.28,-0.25,-0.22,-0.2,-0.19,-0.16,-0.18,-0.18,-0.17,-0.15,-0.07000000000000001,-0.03,-0.01,0.01,0,0.02,0.05,0.09,0.1,0.12,0.16,0.2,0.2,0.21,0.21,0.2,0.16,0.17,0.14,0.1,0.11,0.09,0.06,0.03,0.02,0.03,0.03,0.02,-0.02,-0.03,-0.02,0,0.03,0.04,0.05,0.05,0.06,0.06,0.04,0.03,0.06,0.06,0.03,0.05,0.08,0.08,0.11,0.14,0.16,0.15,0.1,0.08,0.09,0.08,0.09,0.08,0.06,0.05,0.02,-0.02,-0.08,-0.14,-0.16,-0.2,-0.22,-0.24,-0.27,-0.27,-0.28,-0.3,-0.34,-0.33,-0.32,-0.31,-0.34,-0.37,-0.39,-0.39,-0.4,-0.42,-0.44,-0.48,-0.53,-0.55,-0.59,-0.63,-0.67,-0.68,-0.73,-0.78,-0.82,-0.84,-0.83,-0.85,-0.87,-0.92,-0.9399999999999999,-0.96,-0.95,-0.95,-0.9399999999999999,-0.93,-0.95,-0.93,-0.91,-0.89,-0.85,-0.85,-0.84,-0.82,-0.77,-0.76,-0.74,-0.71,-0.67,-0.65,-0.64,-0.65,-0.63,-0.61,-0.58,-0.5600000000000001,-0.57,-0.54,-0.5,-0.47,-0.49,-0.44,-0.4,-0.38,-0.34,-0.33,-0.3,-0.3,-0.26,-0.21,-0.17,-0.16,-0.11,-0.08,-0.04,-0.03,0,0.01,0.03,0.07000000000000001,0.09,0.1,0.1,0.11,0.11,0.1,0.15,0.16,0.16,0.15,0.15,0.18,0.18,0.21,0.21,0.24,0.3,0.31,0.31,0.32,0.36,0.38,0.39,0.41,0.42,0.42,0.43,0.46,0.51,0.54,0.6,0.6,0.63,0.62,0.63,0.65,0.66,0.67,0.6899999999999999,0.71,0.71,0.72,0.7,0.74,0.72,0.73,0.73,0.77,0.77,0.76,0.76,0.78,0.78,0.8,0.84,0.89,0.87,0.91,0.95,0.98,0.98,0.99,1,0.98,0.99,0.99,0.92,0.9,0.88,0.85,0.83,0.82,0.79,0.76,0.73,0.74,0.74,0.68,0.61,0.55,0.48,0.41,0.34,0.31,0.23,0.19,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.11,0.08,0.05,0.02,0.01,0.01,-0.02,-0.02,-0.03,-0.04,-0.04,-0.02,-0.02,-0.03,-0.02,-0.02,-0.03,-0.06,-0.06,-0.08,-0.09,-0.09,-0.12,-0.14,-0.13,-0.13,-0.13,-0.13,-0.13,-0.15,-0.17,-0.16,-0.14,-0.16,-0.18,-0.19,-0.2,-0.21,-0.21,-0.22,-0.22,-0.22,-0.22,-0.21,-0.21,-0.22,-0.24,-0.23,-0.22,-0.2,-0.19,-0.19,-0.17,-0.17,-0.15,-0.14,-0.14,-0.13,-0.13,-0.13,-0.15,-0.15,-0.15,-0.13,-0.12,-0.11,-0.12,-0.11,-0.12,-0.12,-0.16,-0.18,-0.19,-0.2,-0.22,-0.24,-0.25,-0.26,-0.24,-0.24,-0.23,-0.22,-0.22,-0.22,-0.22,-0.22,-0.23,-0.23,-0.25,-0.25,-0.24,-0.24,-0.25,-0.24,-0.23,-0.23,-0.22,-0.21,-0.18,-0.18,-0.16,-0.15,-0.13,-0.13,-0.11,-0.12,-0.11,-0.11,-0.11,-0.11,-0.11,-0.13,-0.14,-0.15,-0.15,-0.17,-0.16,-0.15,-0.15,-0.14,-0.13,-0.13,-0.13,-0.13,-0.12,-0.14,-0.15,-0.14,-0.16,-0.16,-0.16,-0.17,-0.16,-0.17,-0.17,-0.18,-0.19,-0.19,-0.19,-0.19,-0.2,-0.18,-0.17,-0.15,-0.16,-0.14,-0.13,-0.13,-0.14,-0.15,-0.17,-0.18,-0.18,-0.2,-0.21,-0.23,-0.22,-0.22,-0.2,-0.2,-0.2,-0.19,-0.19,-0.19,-0.18,-0.19,-0.18,-0.18,-0.18,-0.17,-0.16,-0.14,-0.11,-0.1,-0.09,-0.08,-0.06,-0.04,-0.03,-0.02,-0.01,-0,0.02,0.03,0.04,0.04,0.05,0.05,0.06,0.07000000000000001,0.06,0.05,0.04,0.03,0.02,0.01,-0.01,-0.02,-0.05,-0.05,-0.07000000000000001,-0.1,-0.11,-0.12,-0.13,-0.14,-0.16,-0.17,-0.18,-0.18,-0.21,-0.22,-0.23,-0.24,-0.25,-0.25,-0.27,-0.29,-0.3,-0.31,-0.34,-0.37,-0.38,-0.39,-0.4,-0.4,-0.4,-0.42,-0.41,-0.41,-0.4,-0.4,-0.42,-0.42,-0.43,-0.43,-0.41,-0.4,-0.4,-0.4,-0.41,-0.42,-0.42,-0.45,-0.45,-0.45,-0.45,-0.44,-0.45,-0.46,-0.46,-0.46,-0.46,-0.44,-0.44,-0.43,-0.42,-0.42,-0.44,-0.42,-0.4,-0.4,-0.39,-0.4,-0.41,-0.42,-0.42,-0.42,-0.42,-0.42,-0.42,-0.43,-0.43,-0.43,-0.41,-0.42,-0.42,-0.42,-0.42,-0.43,-0.42,-0.42,-0.42,-0.41,-0.4,-0.39,-0.38,-0.37,-0.35,-0.34,-0.33,-0.31,-0.28,-0.26,-0.22,-0.2,-0.18,-0.17,-0.14,-0.14,-0.12,-0.1,-0.08,-0.07000000000000001,-0.07000000000000001,-0.04,0,0.03,0.05,0.08,0.11,0.12,0.15,0.16,0.18,0.19,0.22,0.25,0.27,0.28,0.3,0.33,0.34,0.35,0.37,0.39,0.4,0.42,0.43,0.44,0.44,0.45,0.48,0.5,0.51,0.53,0.55,0.57,0.57,0.58,0.59,0.6,0.6,0.61,0.61,0.61,0.59,0.59,0.59,0.6,0.59,0.59,0.58,0.58,0.58,0.57,0.5600000000000001,0.54,0.54,0.5,0.49,0.46,0.43,0.42,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,0.91,0.86,0.84,0.84,0.87,0.93,1,1.07,1.13,1.17,1.18,1.17,1.14,1.08,1.01,0.9399999999999999,0.88,0.84,0.82,0.8100000000000001,0.82,0.84,0.86,0.86,0.82,0.75,0.64,0.52,0.39,0.26,0.13,0.02,-0.08,-0.15,-0.19,-0.22,-0.24,-0.25,-0.27,-0.29,-0.34,-0.4,-0.46,-0.51,-0.54,-0.5600000000000001,-0.57,-0.57,-0.55,-0.51,-0.44,-0.35,-0.23,-0.1,0.03,0.16,0.28,0.38,0.45,0.49,0.49,0.44,0.34,0.18,-0.01,-0.23,-0.47,-0.6899999999999999,-0.89,-1.06,-1.19,-1.28,-1.33,-1.33,-1.3,-1.25,-1.18,-1.1,-1.03,-0.96,-0.91,-0.87,-0.84,-0.8100000000000001,-0.79,-0.77,-0.75,-0.73,-0.7,-0.67,-0.63,-0.5600000000000001,-0.47,-0.35,-0.21,-0.05,0.12,0.28,0.41,0.51,0.57,0.58,0.55,0.5,0.43,0.35,0.28,0.23,0.2,0.19,0.2,0.23,0.25,0.27,0.29,0.31,0.31,0.31,0.3,0.29,0.27,0.24,0.22,0.18,0.14,0.1,0.04,-0.03,-0.1,-0.16,-0.21,-0.23,-0.22,-0.18,-0.12,-0.03,0.07000000000000001,0.18,0.28,0.36,0.4,0.38,0.33,0.23,0.11,-0.01,-0.12,-0.2,-0.23,-0.22,-0.18,-0.1,-0.03,0.03,0.06,0.04,-0.03,-0.14,-0.29,-0.46,-0.62,-0.76,-0.87,-0.9399999999999999,-0.99,-1.02,-1.03,-1.05,-1.06,-1.1,-1.15,-1.21,-1.26,-1.31,-1.34,-1.34,-1.32,-1.25,-1.16,-1.03,-0.87,-0.7,-0.52,-0.33,-0.14,0.03,0.17,0.29,0.37,0.42,0.44,0.44,0.42,0.4,0.37,0.34,0.31,0.28,0.25,0.22,0.2,0.18,0.18,0.19,0.21,0.24,0.28,0.32,0.35,0.36,0.35,0.31,0.24,0.17,0.09,0.03,-0.02,-0.05,-0.08,-0.1,-0.11,-0.13,-0.14,-0.15,-0.15,-0.14,-0.11,-0.06,-0.01,0.05,0.12,0.19,0.23,0.25,0.23,0.18,0.1,0,-0.1,-0.2,-0.28,-0.33,-0.37,-0.38,-0.38,-0.35,-0.29,-0.22,-0.12,-0.02,0.09,0.19,0.29,0.37,0.45,0.5,0.54,0.5600000000000001,0.55,0.54,0.51,0.49,0.47,0.45,0.43,0.4,0.35,0.29,0.2,0.1,-0.02,-0.15,-0.29,-0.44,-0.6,-0.74,-0.88,-1,-1.1,-1.18,-1.24,-1.28,-1.3,-1.29,-1.28,-1.24,-1.2,-1.15,-1.11,-1.07,-1.04,-1.01,-0.99,-0.98,-0.97,-0.96,-0.96,-0.95,-0.96,-0.97,-0.98,-1,-1.03,-1.05,-1.08,-1.11,-1.13,-1.14,-1.12,-1.1,-1.06,-1,-0.93,-0.84,-0.74,-0.64,-0.55,-0.47,-0.39,-0.33,-0.28,-0.23,-0.2,-0.18,-0.17,-0.17,-0.18,-0.19,-0.2,-0.2,-0.19,-0.19,-0.2,-0.2,-0.21,-0.21,-0.2,-0.2,-0.19,-0.18,-0.16,-0.14,-0.09,-0.04,0.03,0.11,0.18,0.23,0.27,0.29,0.31,0.32,0.33,0.34,0.34,0.35,0.35,0.36,0.37,0.39,0.41,0.43,0.44,0.44,0.44,0.43,0.42,0.41,0.39,0.36,0.34,0.32,0.3,0.28,0.28,0.28,0.31,0.36,0.42,0.49,0.5600000000000001,0.63,0.6899999999999999,0.73,0.76,0.77,0.75,0.73,0.72,0.73,0.76,0.82,0.91,1.02,1.14,1.24,1.31,1.35,1.35,1.32,1.27,1.2,1.11,1.03,0.96,0.9,0.86,0.84,0.82,0.8100000000000001,0.8,0.78,0.78,0.78,0.79,0.83,0.88,0.9399999999999999,1.01,1.09,1.16,1.22,1.27,1.28,1.27,1.22,1.14,1.02,0.87,0.7,0.53,0.35,0.19,0.03,-0.11,-0.22,-0.31,-0.37,-0.43,-0.47,-0.52,-0.57,-0.63,-0.71,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.88,0.86,0.83,0.8,0.76,0.72,0.68,0.64,0.6,0.55,0.5,0.44,0.39,0.33,0.28,0.22,0.16,0.11,0.06,0.01,-0.04,-0.08,-0.12,-0.15,-0.18,-0.2,-0.22,-0.23,-0.24,-0.24,-0.24,-0.23,-0.22,-0.21,-0.2,-0.18,-0.17,-0.17,-0.16,-0.16,-0.17,-0.17,-0.19,-0.2,-0.22,-0.25,-0.28,-0.31,-0.34,-0.38,-0.42,-0.46,-0.51,-0.55,-0.59,-0.64,-0.68,-0.72,-0.76,-0.79,-0.8100000000000001,-0.84,-0.85,-0.86,-0.85,-0.84,-0.82,-0.8,-0.76,-0.72,-0.67,-0.62,-0.57,-0.52,-0.46,-0.4,-0.34,-0.28,-0.23,-0.18,-0.12,-0.08,-0.03,0.01,0.05,0.09,0.13,0.16,0.19,0.21,0.23,0.25,0.26,0.27,0.28,0.28,0.28,0.28,0.27,0.25,0.24,0.22,0.21,0.19,0.17,0.16,0.14,0.13,0.12,0.12,0.11,0.1,0.1,0.09,0.08,0.08,0.07000000000000001,0.06,0.06,0.05,0.05,0.05,0.04,0.04,0.04,0.03,0.03,0.02,0.01,-0,-0.02,-0.03,-0.05,-0.08,-0.1,-0.13,-0.17,-0.2,-0.24,-0.29,-0.33,-0.38,-0.43,-0.48,-0.54,-0.59,-0.64,-0.68,-0.73,-0.77,-0.8,-0.83,-0.86,-0.88,-0.89,-0.89,-0.89,-0.89,-0.87,-0.85,-0.82,-0.78,-0.74,-0.6899999999999999,-0.64,-0.58,-0.52,-0.46,-0.4,-0.34,-0.27,-0.22,-0.16,-0.1,-0.05,0,0.05,0.09,0.13,0.17,0.2,0.22,0.24,0.25,0.26,0.26,0.26,0.26,0.25,0.24,0.23,0.21,0.2,0.18,0.17,0.15,0.14,0.12,0.11,0.1,0.09,0.08,0.07000000000000001,0.06,0.05,0.05,0.04,0.03,0.02,0.01,0.01,-0,-0.01,-0.02,-0.03,-0.04,-0.04,-0.05,-0.05,-0.05,-0.06,-0.05,-0.05,-0.05,-0.04,-0.04,-0.03,-0.02,-0.01,0.01,0.02,0.04,0.06,0.08,0.1,0.12,0.14,0.16,0.18,0.2,0.21,0.22,0.23,0.23,0.23,0.22,0.2,0.18,0.15,0.11,0.07000000000000001,0.02,-0.03,-0.09,-0.15,-0.22,-0.28,-0.35,-0.42,-0.48,-0.55,-0.61,-0.67,-0.73,-0.78,-0.83,-0.87,-0.91,-0.9399999999999999,-0.97,-1,-1.02,-1.04,-1.05,-1.06,-1.07,-1.07,-1.07,-1.07,-1.07,-1.06,-1.06,-1.05,-1.04,-1.03,-1.02,-1,-0.99,-0.97,-0.95,-0.93,-0.91,-0.89,-0.86,-0.84,-0.8100000000000001,-0.78,-0.75,-0.71,-0.68,-0.65,-0.61,-0.58,-0.54,-0.51,-0.47,-0.44,-0.41,-0.38,-0.35,-0.32,-0.3,-0.27,-0.25,-0.23,-0.21,-0.19,-0.17,-0.15,-0.14,-0.12,-0.1,-0.08,-0.07000000000000001,-0.05,-0.03,-0.01,0.02,0.04,0.06,0.09,0.11,0.13,0.16,0.18,0.2,0.22,0.25,0.26,0.28,0.3,0.31,0.32,0.33,0.34,0.35,0.36,0.36,0.37,0.38,0.38,0.39,0.39,0.4,0.41,0.42,0.42,0.43,0.44,0.46,0.47,0.49,0.51,0.53,0.5600000000000001,0.58,0.61,0.64,0.67,0.7,0.73,0.76,0.79,0.82,0.85,0.87,0.9,0.92,0.9399999999999999,0.95,0.97,0.98,0.99,0.99,1,1,1,1,1,1,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.98,0.98,0.97,0.96,0.9399999999999999,0.93,0.91,0.89,0.86,0.84,0.8100000000000001,0.77,0.73,0.6899999999999999,0.64,0.58,0.52,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.05,0.02,-0,-0.03,-0.05,-0.08,-0.1,-0.13,-0.15,-0.18,-0.2,-0.22,-0.24,-0.26,-0.28,-0.3,-0.32,-0.33,-0.35,-0.36,-0.38,-0.39,-0.4,-0.41,-0.42,-0.43,-0.43,-0.44,-0.44,-0.44,-0.45,-0.45,-0.44,-0.44,-0.44,-0.44,-0.43,-0.43,-0.42,-0.41,-0.4,-0.39,-0.38,-0.37,-0.36,-0.35,-0.34,-0.33,-0.31,-0.3,-0.29,-0.27,-0.26,-0.24,-0.23,-0.21,-0.2,-0.18,-0.17,-0.15,-0.13,-0.12,-0.1,-0.08,-0.07000000000000001,-0.05,-0.04,-0.02,-0.01,0.01,0.02,0.03,0.04,0.06,0.07000000000000001,0.07000000000000001,0.08,0.09,0.09,0.1,0.1,0.1,0.1,0.1,0.1,0.09,0.09,0.08,0.07000000000000001,0.06,0.05,0.04,0.03,0.02,0,-0.01,-0.03,-0.05,-0.06,-0.08,-0.1,-0.12,-0.14,-0.16,-0.18,-0.19,-0.21,-0.23,-0.25,-0.26,-0.28,-0.3,-0.31,-0.33,-0.34,-0.35,-0.36,-0.38,-0.39,-0.4,-0.4,-0.41,-0.42,-0.42,-0.43,-0.43,-0.43,-0.43,-0.43,-0.43,-0.43,-0.42,-0.42,-0.41,-0.4,-0.4,-0.39,-0.38,-0.37,-0.36,-0.35,-0.33,-0.32,-0.31,-0.29,-0.28,-0.26,-0.25,-0.23,-0.21,-0.2,-0.18,-0.16,-0.15,-0.13,-0.11,-0.1,-0.08,-0.07000000000000001,-0.05,-0.04,-0.03,-0.02,-0,0.01,0.02,0.03,0.03,0.04,0.05,0.05,0.06,0.06,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.05,0.05,0.05,0.05,0.04,0.04,0.04,0.03,0.03,0.02,0.02,0.01,0,-0.01,-0.02,-0.03,-0.04,-0.05,-0.06,-0.08,-0.09,-0.1,-0.12,-0.14,-0.15,-0.17,-0.19,-0.21,-0.23,-0.25,-0.27,-0.29,-0.31,-0.34,-0.36,-0.38,-0.4,-0.43,-0.45,-0.47,-0.5,-0.52,-0.54,-0.5600000000000001,-0.58,-0.6,-0.62,-0.64,-0.66,-0.68,-0.6899999999999999,-0.71,-0.72,-0.74,-0.75,-0.76,-0.77,-0.78,-0.79,-0.79,-0.8,-0.8,-0.8,-0.8,-0.8,-0.79,-0.79,-0.78,-0.78,-0.77,-0.76,-0.74,-0.73,-0.72,-0.7,-0.68,-0.67,-0.65,-0.63,-0.61,-0.59,-0.57,-0.54,-0.52,-0.5,-0.47,-0.45,-0.43,-0.4,-0.38,-0.36,-0.33,-0.31,-0.29,-0.26,-0.24,-0.22,-0.2,-0.17,-0.15,-0.13,-0.11,-0.09,-0.07000000000000001,-0.05,-0.03,-0.01,0.01,0.03,0.05,0.07000000000000001,0.09,0.11,0.13,0.14,0.16,0.18,0.19,0.21,0.23,0.25,0.26,0.28,0.3,0.31,0.33,0.35,0.36,0.38,0.4,0.41,0.43,0.45,0.46,0.48,0.49,0.51,0.53,0.54,0.5600000000000001,0.57,0.59,0.6,0.62,0.63,0.65,0.66,0.68,0.6899999999999999,0.71,0.72,0.73,0.75,0.76,0.77,0.78,0.79,0.8,0.8100000000000001,0.8100000000000001,0.82,0.83,0.83,0.83,0.83,0.84,0.83,0.83,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[2.2,1.87,1.6,1.4,1.27,1.2,1.16,1.12,1.05,0.92,0.77,0.63,0.55,0.5600000000000001,0.65,0.8,1,1.23,1.43,1.57,1.59,1.46,1.23,0.97,0.76,0.64,0.61,0.65,0.71,0.79,0.87,0.9399999999999999,1.01,1.05,1.05,0.99,0.84,0.6,0.31,0.02,-0.21,-0.33,-0.36,-0.33,-0.27,-0.22,-0.17,-0.15,-0.16,-0.2,-0.28,-0.38,-0.49,-0.62,-0.73,-0.8,-0.8,-0.73,-0.6,-0.47,-0.37,-0.34,-0.32,-0.27,-0.12,0.15,0.48,0.79,0.99,1.01,0.88,0.66,0.42,0.19,-0.04,-0.27,-0.53,-0.82,-1.16,-1.49,-1.75,-1.85,-1.76,-1.54,-1.28,-1.05,-0.9399999999999999,-0.9,-0.92,-0.9399999999999999,-0.92,-0.89,-0.84,-0.78,-0.73,-0.6899999999999999,-0.68,-0.68,-0.72,-0.76,-0.78,-0.76,-0.67,-0.52,-0.31,-0.04,0.26,0.57,0.83,0.99,1.02,0.93,0.76,0.53,0.3,0.09,-0.06,-0.11,-0.05,0.09,0.25,0.38,0.42,0.41,0.36,0.31,0.28,0.27,0.28,0.29,0.3,0.3,0.29,0.25,0.19,0.11,0.02,-0.07000000000000001,-0.16,-0.25,-0.32,-0.39,-0.45,-0.46,-0.4,-0.24,0.03,0.36,0.67,0.87,0.91,0.8100000000000001,0.6,0.32,0.01,-0.3,-0.55,-0.71,-0.73,-0.59,-0.34,-0.04,0.25,0.47,0.59,0.58,0.41,0.07000000000000001,-0.35,-0.78,-1.12,-1.29,-1.32,-1.25,-1.12,-0.97,-0.83,-0.75,-0.78,-0.92,-1.14,-1.37,-1.54,-1.62,-1.6,-1.54,-1.44,-1.34,-1.24,-1.11,-0.9399999999999999,-0.73,-0.49,-0.22,0.05,0.3,0.52,0.67,0.73,0.6899999999999999,0.57,0.44,0.32,0.27,0.27,0.29,0.32,0.33,0.32,0.28,0.21,0.11,0.01,-0.05,-0.02,0.11,0.3,0.5,0.65,0.6899999999999999,0.64,0.51,0.31,0.07000000000000001,-0.16,-0.34,-0.39,-0.29,-0.1,0.09,0.19,0.12,-0.05,-0.26,-0.44,-0.51,-0.44,-0.24,-0,0.23,0.4,0.5,0.53,0.5,0.41,0.28,0.12,-0.06,-0.23,-0.38,-0.5,-0.57,-0.57,-0.54,-0.47,-0.4,-0.33,-0.26,-0.17,-0.05,0.1,0.28,0.45,0.59,0.68,0.71,0.7,0.66,0.59,0.52,0.45,0.4,0.4,0.41,0.45,0.47,0.48,0.46,0.39,0.25,0.04,-0.21,-0.46,-0.66,-0.79,-0.87,-0.9399999999999999,-1.04,-1.19,-1.36,-1.5,-1.57,-1.54,-1.43,-1.3,-1.17,-1.08,-1.03,-1.01,-1.01,-1.01,-1.01,-1,-0.99,-0.96,-0.93,-0.9,-0.89,-0.89,-0.92,-0.97,-1.02,-1.06,-1.09,-1.11,-1.13,-1.16,-1.2,-1.24,-1.26,-1.22,-1.14,-1,-0.84,-0.67,-0.51,-0.37,-0.27,-0.21,-0.21,-0.23,-0.25,-0.23,-0.18,-0.1,-0.04,-0.03,-0.11,-0.23,-0.33,-0.38,-0.33,-0.22,-0.11,-0.04,-0.07000000000000001,-0.15,-0.25,-0.33,-0.34,-0.3,-0.22,-0.12,-0.02,0.07000000000000001,0.17,0.26,0.35,0.42,0.46,0.45,0.39,0.29,0.22,0.19,0.24,0.34,0.44,0.5,0.49,0.44,0.38,0.36,0.4,0.47,0.54,0.5600000000000001,0.51,0.42,0.31,0.23,0.19,0.2,0.23,0.26,0.28,0.27,0.26,0.28,0.37,0.53,0.74,0.93,1.05,1.07,1,0.86,0.68,0.5,0.37,0.32,0.43,0.71,1.09,1.47,1.75,1.85,1.79,1.63,1.42,1.19,0.98,0.83,0.75,0.77,0.85,0.93,0.96,0.91,0.8100000000000001,0.7,0.62,0.62,0.66,0.74,0.8100000000000001,0.87,0.92,0.98,1.07,1.21,1.37,1.51,1.59,1.58,1.49,1.33,1.11,0.87,0.6,0.35,0.12,-0.05,-0.18,-0.28,-0.37,-0.45,-0.52,-0.57,-0.57,-0.53,-0.47,-0.45,-0.49,-0.62,-0.83,-1.08,-1.32,-1.53,-1.71,-1.87,-2.01,-2.14],[1.9,1.76,1.62,1.49,1.36,1.25,1.15,1.07,0.99,0.93,0.88,0.85,0.84,0.86,0.89,0.9399999999999999,0.99,1.05,1.09,1.12,1.14,1.12,1.09,1.05,1.01,0.97,0.9399999999999999,0.92,0.9,0.89,0.88,0.86,0.83,0.79,0.73,0.66,0.57,0.46,0.34,0.21,0.1,0.01,-0.08,-0.14,-0.2,-0.25,-0.29,-0.33,-0.37,-0.41,-0.45,-0.5,-0.54,-0.57,-0.59,-0.6,-0.58,-0.54,-0.49,-0.41,-0.32,-0.22,-0.11,0.01,0.13,0.25,0.35,0.43,0.48,0.48,0.43,0.34,0.21,0.05,-0.13,-0.33,-0.53,-0.73,-0.91,-1.07,-1.19,-1.28,-1.32,-1.32,-1.3,-1.26,-1.21,-1.16,-1.1,-1.05,-1,-0.95,-0.91,-0.87,-0.83,-0.79,-0.75,-0.71,-0.66,-0.61,-0.54,-0.45,-0.34,-0.22,-0.08,0.05,0.19,0.31,0.42,0.49,0.53,0.54,0.52,0.48,0.43,0.38,0.33,0.29,0.27,0.26,0.27,0.27,0.28,0.29,0.29,0.3,0.29,0.29,0.28,0.26,0.24,0.21,0.18,0.13,0.08,0.03,-0.02,-0.07000000000000001,-0.12,-0.15,-0.17,-0.17,-0.14,-0.1,-0.05,0.02,0.11,0.19,0.26,0.3,0.31,0.28,0.23,0.17,0.1,0.03,-0.04,-0.08,-0.11,-0.1,-0.08,-0.04,-0.02,-0.01,-0.03,-0.07000000000000001,-0.15,-0.25,-0.38,-0.52,-0.65,-0.76,-0.86,-0.93,-1,-1.05,-1.09,-1.13,-1.18,-1.23,-1.28,-1.33,-1.37,-1.38,-1.37,-1.33,-1.27,-1.18,-1.07,-0.93,-0.78,-0.61,-0.43,-0.25,-0.09,0.07000000000000001,0.2,0.31,0.39,0.44,0.46,0.46,0.45,0.43,0.4,0.37,0.34,0.31,0.29,0.26,0.24,0.23,0.22,0.22,0.24,0.26,0.29,0.31,0.32,0.31,0.29,0.25,0.19,0.13,0.07000000000000001,0.01,-0.04,-0.07000000000000001,-0.09,-0.1,-0.11,-0.12,-0.13,-0.14,-0.13,-0.11,-0.07000000000000001,-0.01,0.05,0.1,0.15,0.18,0.19,0.18,0.14,0.08,0.01,-0.07000000000000001,-0.15,-0.22,-0.29,-0.33,-0.36,-0.36,-0.34,-0.3,-0.24,-0.17,-0.08,0.01,0.11,0.21,0.31,0.4,0.47,0.53,0.5600000000000001,0.59,0.6,0.59,0.58,0.5600000000000001,0.54,0.5,0.46,0.41,0.34,0.26,0.15,0.04,-0.1,-0.24,-0.39,-0.54,-0.68,-0.82,-0.9399999999999999,-1.05,-1.14,-1.22,-1.28,-1.31,-1.32,-1.31,-1.29,-1.25,-1.21,-1.17,-1.13,-1.09,-1.05,-1.02,-1,-0.98,-0.97,-0.96,-0.96,-0.96,-0.97,-0.99,-1.01,-1.04,-1.07,-1.09,-1.11,-1.12,-1.13,-1.13,-1.11,-1.08,-1.03,-0.96,-0.88,-0.79,-0.7,-0.61,-0.52,-0.44,-0.37,-0.31,-0.26,-0.22,-0.19,-0.17,-0.16,-0.15,-0.15,-0.16,-0.17,-0.19,-0.2,-0.21,-0.21,-0.21,-0.2,-0.21,-0.21,-0.2,-0.19,-0.17,-0.14,-0.1,-0.05,0.01,0.06,0.12,0.18,0.22,0.27,0.3,0.32,0.34,0.35,0.35,0.36,0.37,0.39,0.4,0.42,0.42,0.43,0.43,0.43,0.43,0.42,0.41,0.4,0.38,0.36,0.33,0.31,0.3,0.29,0.29,0.3,0.32,0.35,0.39,0.44,0.49,0.55,0.61,0.66,0.7,0.73,0.75,0.76,0.77,0.79,0.82,0.87,0.93,1.01,1.11,1.19,1.26,1.3,1.31,1.3,1.27,1.21,1.15,1.08,1.02,0.96,0.91,0.88,0.84,0.8100000000000001,0.79,0.77,0.77,0.78,0.8100000000000001,0.85,0.9,0.96,1.02,1.09,1.15,1.21,1.25,1.27,1.27,1.23,1.16,1.07,0.95,0.8100000000000001,0.65,0.49,0.33,0.18,0.04,-0.08,-0.19,-0.28,-0.36,-0.43,-0.5,-0.5600000000000001,-0.62,-0.6899999999999999,-0.78,-0.88,-1.01,-1.14,-1.29,-1.44,-1.6,-1.77,-1.93,-2.09],[1.52,1.48,1.44,1.4,1.36,1.33,1.29,1.26,1.23,1.2,1.17,1.14,1.12,1.1,1.08,1.06,1.05,1.03,1.01,1,0.98,0.96,0.93,0.91,0.88,0.85,0.82,0.79,0.75,0.72,0.68,0.64,0.59,0.55,0.5,0.45,0.4,0.34,0.29,0.24,0.18,0.13,0.08,0.04,-0,-0.04,-0.08,-0.11,-0.14,-0.17,-0.19,-0.21,-0.23,-0.24,-0.25,-0.25,-0.25,-0.25,-0.25,-0.24,-0.23,-0.23,-0.22,-0.22,-0.21,-0.21,-0.22,-0.23,-0.24,-0.27,-0.29,-0.33,-0.37,-0.41,-0.46,-0.5,-0.55,-0.6,-0.65,-0.6899999999999999,-0.74,-0.77,-0.8,-0.82,-0.84,-0.85,-0.86,-0.86,-0.85,-0.84,-0.82,-0.8,-0.77,-0.74,-0.7,-0.66,-0.62,-0.57,-0.52,-0.47,-0.41,-0.35,-0.3,-0.24,-0.18,-0.12,-0.06,-0.01,0.04,0.08,0.12,0.16,0.19,0.21,0.24,0.25,0.27,0.28,0.29,0.29,0.3,0.3,0.3,0.3,0.29,0.28,0.28,0.27,0.26,0.24,0.23,0.22,0.2,0.19,0.18,0.16,0.15,0.14,0.13,0.12,0.11,0.1,0.1,0.09,0.09,0.09,0.08,0.08,0.07000000000000001,0.07000000000000001,0.05,0.04,0.02,0,-0.02,-0.05,-0.07000000000000001,-0.1,-0.13,-0.17,-0.2,-0.24,-0.27,-0.31,-0.36,-0.4,-0.45,-0.5,-0.55,-0.6,-0.65,-0.7,-0.74,-0.78,-0.82,-0.85,-0.88,-0.9,-0.91,-0.92,-0.93,-0.93,-0.92,-0.9,-0.87,-0.84,-0.8,-0.76,-0.7,-0.65,-0.59,-0.52,-0.45,-0.39,-0.32,-0.25,-0.19,-0.13,-0.07000000000000001,-0.02,0.03,0.07000000000000001,0.11,0.15,0.17,0.2,0.22,0.24,0.25,0.26,0.27,0.27,0.27,0.27,0.27,0.26,0.26,0.25,0.24,0.22,0.21,0.19,0.17,0.15,0.13,0.11,0.1,0.08,0.06,0.05,0.03,0.02,0.01,0,-0.01,-0.01,-0.02,-0.02,-0.02,-0.02,-0.02,-0.03,-0.03,-0.03,-0.03,-0.03,-0.03,-0.03,-0.03,-0.02,-0.02,-0.01,0,0.02,0.03,0.05,0.07000000000000001,0.1,0.12,0.15,0.17,0.19,0.21,0.23,0.24,0.25,0.26,0.26,0.25,0.24,0.23,0.2,0.18,0.14,0.1,0.06,0.01,-0.05,-0.11,-0.17,-0.24,-0.3,-0.37,-0.44,-0.51,-0.58,-0.65,-0.71,-0.77,-0.82,-0.87,-0.92,-0.96,-0.99,-1.02,-1.05,-1.07,-1.09,-1.1,-1.11,-1.12,-1.12,-1.12,-1.12,-1.12,-1.12,-1.11,-1.1,-1.1,-1.09,-1.07,-1.06,-1.05,-1.03,-1.01,-0.99,-0.96,-0.9399999999999999,-0.91,-0.88,-0.84,-0.8100000000000001,-0.77,-0.73,-0.6899999999999999,-0.65,-0.61,-0.57,-0.53,-0.5,-0.46,-0.43,-0.4,-0.36,-0.34,-0.31,-0.28,-0.26,-0.24,-0.22,-0.2,-0.18,-0.16,-0.14,-0.12,-0.1,-0.08,-0.06,-0.04,-0.02,0,0.03,0.05,0.07000000000000001,0.09,0.12,0.14,0.16,0.18,0.2,0.22,0.24,0.26,0.27,0.29,0.3,0.31,0.32,0.33,0.34,0.35,0.36,0.36,0.37,0.38,0.38,0.39,0.4,0.4,0.41,0.42,0.43,0.44,0.46,0.47,0.49,0.51,0.53,0.5600000000000001,0.58,0.61,0.64,0.67,0.6899999999999999,0.72,0.75,0.78,0.8100000000000001,0.84,0.86,0.89,0.92,0.9399999999999999,0.97,0.99,1.01,1.03,1.04,1.06,1.06,1.07,1.07,1.08,1.08,1.08,1.07,1.07,1.07,1.07,1.07,1.06,1.06,1.06,1.05,1.05,1.04,1.03,1.02,1.01,0.99,0.97,0.9399999999999999,0.91,0.87,0.82,0.77,0.72,0.65,0.58,0.51,0.43,0.34,0.26,0.17,0.07000000000000001,-0.02,-0.12,-0.22,-0.31,-0.42,-0.52,-0.62,-0.73,-0.84,-0.95,-1.06,-1.17,-1.29,-1.4,-1.52,-1.63,-1.75,-1.87],[2.09,1.88,1.69,1.52,1.37,1.23,1.11,1.01,0.91,0.8100000000000001,0.73,0.68,0.66,0.65,0.6899999999999999,0.82,1.05,1.27,1.4,1.41,1.38,1.32,1.23,1.07,0.9,0.78,0.71,0.66,0.64,0.7,0.83,0.96,1.01,1,0.96,0.89,0.78,0.59,0.32,0.06,-0.13,-0.23,-0.29,-0.34,-0.33,-0.26,-0.18,-0.14,-0.17,-0.23,-0.3,-0.39,-0.52,-0.64,-0.7,-0.7,-0.67,-0.64,-0.62,-0.59,-0.54,-0.45,-0.29,-0.08,0.12,0.28,0.44,0.64,0.8,0.87,0.8100000000000001,0.67,0.5,0.28,-0.01,-0.32,-0.59,-0.89,-1.23,-1.47,-1.57,-1.58,-1.56,-1.51,-1.4,-1.2,-1.06,-0.99,-0.9399999999999999,-0.9,-0.87,-0.84,-0.8,-0.76,-0.74,-0.73,-0.75,-0.76,-0.75,-0.75,-0.75,-0.7,-0.58,-0.4,-0.2,-0,0.25,0.5600000000000001,0.78,0.84,0.84,0.79,0.73,0.57,0.32,0.15,0.09,0.07000000000000001,0.08,0.1,0.15,0.24,0.34,0.38,0.38,0.35,0.31,0.29,0.3,0.32,0.31,0.29,0.26,0.24,0.2,0.12,0.01,-0.08,-0.18,-0.29,-0.38,-0.42,-0.41,-0.37,-0.3,-0.13,0.14,0.41,0.58,0.65,0.68,0.66,0.58,0.37,0.03,-0.29,-0.48,-0.54,-0.54,-0.5,-0.33,-0.03,0.28,0.43,0.43,0.36,0.24,0.01,-0.34,-0.7,-0.95,-1.08,-1.18,-1.24,-1.19,-1.06,-0.92,-0.87,-0.93,-1.04,-1.17,-1.27,-1.36,-1.47,-1.55,-1.57,-1.5,-1.36,-1.22,-1.07,-0.88,-0.67,-0.46,-0.21,0.08,0.31,0.44,0.54,0.61,0.65,0.59,0.46,0.38,0.36,0.35,0.35,0.33,0.29,0.24,0.18,0.15,0.12,0.09,0.08,0.09,0.19,0.35,0.45,0.49,0.52,0.52,0.47,0.3,0.05,-0.12,-0.15,-0.13,-0.1,-0.09,-0.08,-0.05,-0.05,-0.1,-0.21,-0.3,-0.33,-0.26,-0.12,0.02,0.14,0.25,0.37,0.46,0.49,0.41,0.26,0.12,-0.02,-0.2,-0.37,-0.47,-0.51,-0.52,-0.52,-0.49,-0.44,-0.36,-0.26,-0.13,0.04,0.18,0.29,0.41,0.51,0.59,0.64,0.65,0.63,0.61,0.57,0.5,0.45,0.41,0.44,0.48,0.48,0.44,0.38,0.3,0.2,0.02,-0.22,-0.42,-0.58,-0.73,-0.87,-0.99,-1.13,-1.26,-1.35,-1.4,-1.42,-1.42,-1.4,-1.35,-1.25,-1.14,-1.06,-1.02,-1.01,-1.01,-1,-0.99,-0.97,-0.96,-0.9399999999999999,-0.93,-0.91,-0.92,-0.9399999999999999,-0.97,-1,-1.03,-1.09,-1.14,-1.18,-1.21,-1.24,-1.23,-1.2,-1.14,-1.07,-0.99,-0.86,-0.68,-0.5,-0.37,-0.31,-0.28,-0.27,-0.24,-0.18,-0.12,-0.09,-0.1,-0.13,-0.17,-0.2,-0.21,-0.22,-0.23,-0.22,-0.21,-0.19,-0.18,-0.19,-0.2,-0.2,-0.21,-0.24,-0.27,-0.26,-0.17,-0.03,0.12,0.23,0.29,0.33,0.35,0.37,0.36,0.33,0.32,0.32,0.32,0.31,0.31,0.35,0.41,0.46,0.46,0.45,0.44,0.43,0.45,0.48,0.49,0.46,0.4,0.33,0.29,0.26,0.23,0.21,0.2,0.22,0.25,0.31,0.38,0.49,0.63,0.73,0.8100000000000001,0.88,0.93,0.95,0.83,0.63,0.52,0.54,0.61,0.71,0.84,1.06,1.37,1.57,1.61,1.58,1.51,1.44,1.32,1.15,0.98,0.86,0.82,0.82,0.83,0.83,0.8100000000000001,0.79,0.77,0.74,0.71,0.6899999999999999,0.7,0.76,0.85,0.93,1.03,1.16,1.28,1.37,1.45,1.53,1.54,1.44,1.27,1.07,0.87,0.65,0.37,0.14,-0.02,-0.16,-0.29,-0.39,-0.45,-0.49,-0.52,-0.53,-0.51,-0.49,-0.53,-0.62,-0.73,-0.87,-1.02,-1.19,-1.38,-1.59,-1.81,-2.04,-2.3],[1.55,1.5,1.45,1.41,1.37,1.33,1.29,1.26,1.23,1.2,1.18,1.15,1.13,1.11,1.09,1.07,1.06,1.05,1.04,1.04,1.03,1.02,1,1,1.01,1.01,1.01,1,0.97,0.93,0.87,0.8100000000000001,0.74,0.66,0.59,0.52,0.45,0.39,0.32,0.24,0.17,0.09,0.02,-0.04,-0.1,-0.18,-0.27,-0.36,-0.44,-0.5,-0.53,-0.54,-0.53,-0.5,-0.47,-0.43,-0.39,-0.36,-0.32,-0.26,-0.18,-0.09,0,0.08,0.13,0.14,0.13,0.11,0.09,0.06,0.02,-0.02,-0.06,-0.12,-0.22,-0.34,-0.47,-0.6,-0.7,-0.77,-0.84,-0.91,-0.99,-1.07,-1.14,-1.19,-1.22,-1.23,-1.21,-1.18,-1.13,-1.07,-1.01,-0.95,-0.9,-0.83,-0.74,-0.64,-0.53,-0.43,-0.34,-0.27,-0.2,-0.13,-0.06,0.02,0.09,0.15,0.2,0.24,0.28,0.32,0.36,0.39,0.41,0.43,0.44,0.44,0.43,0.41,0.38,0.36,0.33,0.32,0.3,0.27,0.24,0.21,0.18,0.15,0.14,0.12,0.1,0.08,0.06,0.04,0.02,0.01,0.01,0.01,0.02,0.03,0.04,0.04,0.04,0.04,0.05,0.06,0.08,0.09,0.11,0.12,0.12,0.11,0.12,0.12,0.11,0.11,0.09,0.06,0.02,-0.03,-0.1,-0.17,-0.24,-0.31,-0.36,-0.42,-0.49,-0.5600000000000001,-0.63,-0.7,-0.76,-0.8100000000000001,-0.87,-0.95,-1.04,-1.14,-1.22,-1.29,-1.34,-1.35,-1.33,-1.27,-1.2,-1.11,-1.02,-0.9399999999999999,-0.87,-0.79,-0.68,-0.5600000000000001,-0.43,-0.3,-0.19,-0.11,-0.04,0.04,0.12,0.2,0.27,0.33,0.38,0.41,0.42,0.42,0.41,0.4,0.38,0.37,0.36,0.35,0.33,0.31,0.29,0.27,0.25,0.23,0.21,0.18,0.15,0.13,0.1,0.08,0.06,0.05,0.03,0.01,-0,-0.02,-0.03,-0.03,-0.04,-0.03,-0.02,-0.01,0.01,0.02,0.02,0.02,0.01,-0.01,-0.03,-0.05,-0.07000000000000001,-0.09,-0.1,-0.1,-0.11,-0.13,-0.14,-0.15,-0.16,-0.15,-0.13,-0.1,-0.07000000000000001,-0.03,0.01,0.04,0.07000000000000001,0.11,0.18,0.26,0.34,0.42,0.49,0.54,0.5600000000000001,0.5600000000000001,0.54,0.52,0.49,0.45,0.4,0.35,0.27,0.17,0.05,-0.09,-0.22,-0.33,-0.43,-0.51,-0.61,-0.72,-0.82,-0.92,-1.01,-1.07,-1.11,-1.14,-1.17,-1.18,-1.19,-1.2,-1.2,-1.21,-1.2,-1.18,-1.15,-1.11,-1.07,-1.04,-1.03,-1.03,-1.03,-1.05,-1.06,-1.07,-1.07,-1.06,-1.05,-1.05,-1.05,-1.04,-1.03,-1.02,-0.99,-0.96,-0.91,-0.86,-0.8,-0.74,-0.68,-0.63,-0.58,-0.54,-0.48,-0.42,-0.36,-0.31,-0.26,-0.22,-0.2,-0.19,-0.19,-0.19,-0.2,-0.19,-0.18,-0.17,-0.17,-0.17,-0.17,-0.17,-0.16,-0.15,-0.13,-0.1,-0.07000000000000001,-0.03,-0,0.03,0.07000000000000001,0.09,0.12,0.16,0.2,0.24,0.27,0.31,0.33,0.35,0.37,0.39,0.4,0.41,0.42,0.43,0.43,0.42,0.4,0.38,0.36,0.34,0.34,0.34,0.35,0.36,0.36,0.37,0.38,0.39,0.4,0.41,0.42,0.44,0.45,0.47,0.49,0.52,0.5600000000000001,0.62,0.68,0.75,0.8100000000000001,0.87,0.91,0.9399999999999999,0.98,1.02,1.05,1.09,1.11,1.13,1.13,1.12,1.11,1.1,1.08,1.06,1.04,1.04,1.02,1,0.97,0.9399999999999999,0.92,0.89,0.88,0.89,0.92,0.96,1.01,1.04,1.07,1.07,1.06,1.06,1.07,1.06,1.06,1.03,1,0.95,0.88,0.8,0.72,0.64,0.55,0.47,0.39,0.3,0.2,0.1,-0.01,-0.11,-0.22,-0.34,-0.45,-0.58,-0.7,-0.83,-0.96,-1.1,-1.23,-1.37,-1.51,-1.65,-1.8,-1.94,-2.1],[1.59,1.55,1.52,1.48,1.44,1.4,1.36,1.33,1.29,1.25,1.22,1.18,1.14,1.11,1.07,1.04,1,0.97,0.93,0.9,0.86,0.83,0.79,0.76,0.73,0.6899999999999999,0.66,0.63,0.6,0.57,0.54,0.51,0.48,0.45,0.42,0.39,0.36,0.34,0.31,0.28,0.25,0.23,0.2,0.17,0.15,0.12,0.09,0.07000000000000001,0.04,0.01,-0.02,-0.04,-0.07000000000000001,-0.1,-0.12,-0.15,-0.17,-0.2,-0.22,-0.25,-0.28,-0.3,-0.33,-0.36,-0.39,-0.41,-0.44,-0.46,-0.48,-0.5,-0.52,-0.54,-0.55,-0.5600000000000001,-0.57,-0.59,-0.6,-0.61,-0.63,-0.64,-0.65,-0.66,-0.67,-0.67,-0.67,-0.67,-0.67,-0.66,-0.65,-0.64,-0.62,-0.6,-0.58,-0.5600000000000001,-0.54,-0.52,-0.49,-0.47,-0.45,-0.43,-0.4,-0.39,-0.36,-0.33,-0.3,-0.25,-0.21,-0.16,-0.11,-0.06,-0.01,0.04,0.08,0.12,0.15,0.17,0.19,0.2,0.22,0.23,0.24,0.24,0.25,0.26,0.26,0.26,0.26,0.27,0.27,0.27,0.27,0.27,0.26,0.26,0.25,0.24,0.23,0.22,0.21,0.2,0.19,0.17,0.16,0.14,0.13,0.11,0.09,0.06,0.04,0.01,-0.02,-0.05,-0.08,-0.11,-0.14,-0.17,-0.2,-0.23,-0.25,-0.27,-0.3,-0.33,-0.36,-0.4,-0.44,-0.48,-0.52,-0.5600000000000001,-0.59,-0.63,-0.66,-0.68,-0.7,-0.71,-0.71,-0.71,-0.71,-0.71,-0.71,-0.7,-0.7,-0.6899999999999999,-0.68,-0.67,-0.65,-0.64,-0.63,-0.61,-0.6,-0.58,-0.55,-0.52,-0.48,-0.43,-0.38,-0.33,-0.28,-0.23,-0.18,-0.14,-0.1,-0.07000000000000001,-0.04,-0.02,0,0.03,0.06,0.08,0.11,0.14,0.16,0.19,0.21,0.23,0.25,0.26,0.28,0.28,0.28,0.28,0.27,0.25,0.22,0.2,0.17,0.14,0.11,0.09,0.06,0.04,0.03,0.02,0.02,0.01,0.01,0.01,0.01,0,0,0,0,0,0,0,0,0,0,0.01,0.02,0.03,0.05,0.07000000000000001,0.09,0.12,0.14,0.16,0.18,0.19,0.2,0.2,0.2,0.19,0.18,0.16,0.15,0.13,0.11,0.09,0.07000000000000001,0.05,0.02,-0,-0.02,-0.05,-0.07000000000000001,-0.1,-0.12,-0.15,-0.19,-0.24,-0.28,-0.33,-0.38,-0.43,-0.48,-0.53,-0.57,-0.61,-0.65,-0.68,-0.71,-0.74,-0.77,-0.8100000000000001,-0.85,-0.89,-0.9399999999999999,-0.98,-1.02,-1.05,-1.08,-1.11,-1.13,-1.15,-1.16,-1.16,-1.16,-1.14,-1.13,-1.1,-1.08,-1.05,-1.02,-0.99,-0.96,-0.93,-0.91,-0.88,-0.86,-0.84,-0.82,-0.8,-0.77,-0.74,-0.71,-0.67,-0.64,-0.61,-0.57,-0.54,-0.51,-0.48,-0.45,-0.43,-0.4,-0.37,-0.34,-0.31,-0.28,-0.25,-0.22,-0.18,-0.15,-0.12,-0.09,-0.06,-0.04,-0.01,0.01,0.03,0.04,0.06,0.08,0.09,0.11,0.12,0.13,0.14,0.16,0.17,0.19,0.2,0.22,0.23,0.24,0.26,0.27,0.28,0.29,0.3,0.32,0.33,0.34,0.35,0.37,0.38,0.4,0.42,0.44,0.45,0.47,0.49,0.51,0.53,0.55,0.57,0.59,0.61,0.63,0.65,0.66,0.68,0.6899999999999999,0.71,0.73,0.75,0.78,0.8,0.82,0.85,0.87,0.89,0.91,0.92,0.9399999999999999,0.95,0.96,0.98,0.99,1.01,1.03,1.05,1.07,1.09,1.11,1.12,1.13,1.13,1.13,1.13,1.11,1.09,1.07,1.05,1.03,1,0.97,0.9399999999999999,0.91,0.88,0.84,0.8,0.75,0.71,0.66,0.6,0.55,0.49,0.43,0.36,0.3,0.23,0.16,0.08,0.01,-0.07000000000000001,-0.15,-0.24,-0.33,-0.42,-0.51,-0.61,-0.71,-0.8100000000000001,-0.92,-1.03,-1.14,-1.25,-1.37,-1.49,-1.61,-1.73,-1.86]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>yrs<\/th>\n      <th>Z<\/th>\n      <th>ma20<\/th>\n      <th>ma50<\/th>\n      <th>ma100<\/th>\n      <th>han20<\/th>\n      <th>han50<\/th>\n      <th>han100<\/th>\n      <th>ss0.2<\/th>\n      <th>ss0.4<\/th>\n      <th>ss0.6<\/th>\n      <th>f20.lo<\/th>\n      <th>f50.lo<\/th>\n      <th>f100.lo<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":75,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"yrs","targets":1},{"name":"Z","targets":2},{"name":"ma20","targets":3},{"name":"ma50","targets":4},{"name":"ma100","targets":5},{"name":"han20","targets":6},{"name":"han50","targets":7},{"name":"han100","targets":8},{"name":"ss0.2","targets":9},{"name":"ss0.4","targets":10},{"name":"ss0.6","targets":11},{"name":"f20.lo","targets":12},{"name":"f50.lo","targets":13},{"name":"f100.lo","targets":14}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,25,50,75,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="using-filters" class="section level2 hasAnchor" number="11.4">
<h2><span class="header-section-number">11.4</span> Using filters<a href="filtering-smoothing.html#using-filters" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The work above shows how to look at a time series at lower frequencies – it was eye candy. But what if we wanted to use those filters in some kind of analytic way? Here are some examples.</p>
<div id="aggregating" class="section level3 hasAnchor" number="11.4.1">
<h3><span class="header-section-number">11.4.1</span> Aggregating<a href="filtering-smoothing.html#aggregating" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sometimes you have data at one resolution but want it at another (coarser) resolution. E.g., you have hourly counts of fish escapement but want to sum up the hours in a day to get the total fish per day or average it to get fish per hour. We’ve done this already but here is an example worth revisiting.</p>
<p>Let’s go back to the Bellingham airport data. The file <code>kbliMonthlyTavg.rds</code> contains a <code>zoo</code> object with monthly average temperatures from Bellingham. We will use <code>filter</code>, <code>rollmean</code>, and <code>dmseasonal</code>to get summer temperature. Here are three ways of doing the same thing. I’ll work with <code>ts</code>, and <code>zoo</code> objects. And pull in the <code>dm2seasonal</code> function from the wonderful <code>hydroTSM</code> package.</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="filtering-smoothing.html#cb298-1" tabindex="-1"></a>tavgZoo <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data/kbliMonthlyTavg.rds&quot;</span>)</span>
<span id="cb298-2"><a href="filtering-smoothing.html#cb298-2" tabindex="-1"></a>tavgTS <span class="ot">&lt;-</span> <span class="fu">ts</span>(tavgZoo,<span class="at">start=</span><span class="fu">c</span>(<span class="dv">1941</span>,<span class="dv">1</span>),<span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb298-3"><a href="filtering-smoothing.html#cb298-3" tabindex="-1"></a></span>
<span id="cb298-4"><a href="filtering-smoothing.html#cb298-4" tabindex="-1"></a><span class="co"># let&#39;s look at a few years</span></span>
<span id="cb298-5"><a href="filtering-smoothing.html#cb298-5" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">window</span>(tavgTS,<span class="at">start=</span><span class="dv">2000</span>, <span class="at">end =</span> <span class="dv">2004</span>),</span>
<span id="cb298-6"><a href="filtering-smoothing.html#cb298-6" tabindex="-1"></a>     <span class="at">ylab=</span><span class="fu">expression</span>(degree<span class="sc">*</span>C))</span></code></pre></div>
<p><img src="08TimeSeries-Filters_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="filtering-smoothing.html#cb299-1" tabindex="-1"></a><span class="co"># get summer (JJA) temps three ways</span></span>
<span id="cb299-2"><a href="filtering-smoothing.html#cb299-2" tabindex="-1"></a><span class="co"># 1. using filter on a ts object</span></span>
<span id="cb299-3"><a href="filtering-smoothing.html#cb299-3" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">filter</span>(tavgTS, <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>,<span class="dv">3</span>), <span class="at">sides =</span> <span class="dv">1</span>)</span>
<span id="cb299-4"><a href="filtering-smoothing.html#cb299-4" tabindex="-1"></a>summerTavg_v1 <span class="ot">&lt;-</span> tmp[<span class="fu">seq</span>(<span class="dv">8</span>,<span class="fu">length</span>(tmp),<span class="at">by=</span><span class="dv">12</span>)]</span>
<span id="cb299-5"><a href="filtering-smoothing.html#cb299-5" tabindex="-1"></a><span class="co"># 2. using zoo -- essentially the exact same as above</span></span>
<span id="cb299-6"><a href="filtering-smoothing.html#cb299-6" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">rollmean</span>(tavgZoo,<span class="at">k=</span><span class="dv">3</span>, <span class="at">align =</span> <span class="st">&quot;right&quot;</span>)</span>
<span id="cb299-7"><a href="filtering-smoothing.html#cb299-7" tabindex="-1"></a>summerTavg_v2 <span class="ot">&lt;-</span> tmp[<span class="fu">months</span>(<span class="fu">time</span>(tmp)) <span class="sc">==</span> <span class="st">&quot;August&quot;</span>]</span>
<span id="cb299-8"><a href="filtering-smoothing.html#cb299-8" tabindex="-1"></a><span class="co"># 3. using hydroTSM</span></span>
<span id="cb299-9"><a href="filtering-smoothing.html#cb299-9" tabindex="-1"></a>summerTavg_v3 <span class="ot">&lt;-</span> hydroTSM<span class="sc">::</span><span class="fu">dm2seasonal</span>(tavgZoo,<span class="at">season=</span><span class="st">&quot;JJA&quot;</span>,<span class="at">FUN=</span>mean)</span>
<span id="cb299-10"><a href="filtering-smoothing.html#cb299-10" tabindex="-1"></a><span class="co"># note they are all the same</span></span>
<span id="cb299-11"><a href="filtering-smoothing.html#cb299-11" tabindex="-1"></a><span class="fu">head</span>(summerTavg_v1)</span></code></pre></div>
<pre><code>## [1] 15.71615 16.04912 14.60194 15.79032 14.75443 15.26229</code></pre>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="filtering-smoothing.html#cb301-1" tabindex="-1"></a><span class="fu">head</span>(summerTavg_v2)</span></code></pre></div>
<pre><code>## 1941-08-01 1942-08-01 1943-08-01 1944-08-01 1945-08-01 1946-08-01 
##   15.71615   16.04912   14.60194   15.67921   15.10165   15.42063</code></pre>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="filtering-smoothing.html#cb303-1" tabindex="-1"></a><span class="fu">head</span>(summerTavg_v3)</span></code></pre></div>
<pre><code>##     1941     1942     1943     1944     1945     1946 
## 15.71615 16.04912 14.60194 15.67921 15.10165 15.42063</code></pre>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="filtering-smoothing.html#cb305-1" tabindex="-1"></a><span class="co"># Looks like it is getting warmer.</span></span>
<span id="cb305-2"><a href="filtering-smoothing.html#cb305-2" tabindex="-1"></a><span class="fu">plot</span>(summerTavg_v2,<span class="at">ylab=</span><span class="fu">expression</span>(degree<span class="sc">*</span>C),<span class="at">xlab=</span><span class="st">&quot;Time&quot;</span>)</span>
<span id="cb305-3"><a href="filtering-smoothing.html#cb305-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(summerTavg_v2<span class="sc">~</span><span class="fu">time</span>(summerTavg_v2)),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="08TimeSeries-Filters_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
<p>Go through the code and make sure you follow what just happened at each step.</p>
</div>
<div id="removing-low-frequency-variability" class="section level3 hasAnchor" number="11.4.2">
<h3><span class="header-section-number">11.4.2</span> Removing low frequency variability<a href="filtering-smoothing.html#removing-low-frequency-variability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sometimes we use filters as visual aids that help us see certain aspects of the data. Other times we want to work only with low or high frequency data. A common way of removing some kinds of variability is to take residuals from a filter to remove, say, low-frequency variability.</p>
<p>For instance, a perennial problem in working with tree-ring data is the problem of detrending the biological growth curve from the signal that you usually want – the year-to-year variability caused by, say, plant available water. Smaller trees have larger rings solely as a function of geometry. This leads to a natural negative exponential decay in growth as the tree ages that has nothing to do with climate. We can remove that signal by fitting a loess curve and then taking the residuals via division (subtraction can be used too). Dendrochronologists call this the ring-width index.</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="filtering-smoothing.html#cb306-1" tabindex="-1"></a><span class="fu">data</span>(co021)</span>
<span id="cb306-2"><a href="filtering-smoothing.html#cb306-2" tabindex="-1"></a>core1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">yr =</span> <span class="fu">time</span>(co021), <span class="at">mm =</span> co021<span class="sc">$</span><span class="st">`</span><span class="at">641114</span><span class="st">`</span>)</span>
<span id="cb306-3"><a href="filtering-smoothing.html#cb306-3" tabindex="-1"></a>core1 <span class="ot">&lt;-</span> core1 <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>()</span>
<span id="cb306-4"><a href="filtering-smoothing.html#cb306-4" tabindex="-1"></a>core1</span></code></pre></div>
<pre><code>## # A tibble: 694 × 2
##       yr    mm
##    &lt;dbl&gt; &lt;dbl&gt;
##  1  1270  1.48
##  2  1271  2.33
##  3  1272  1.32
##  4  1273  0.67
##  5  1274  0.82
##  6  1275  1.22
##  7  1276  0.52
##  8  1277  0.57
##  9  1278  0.4 
## 10  1279  0.65
## # ℹ 684 more rows</code></pre>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="filtering-smoothing.html#cb308-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(core1)</span>
<span id="cb308-2"><a href="filtering-smoothing.html#cb308-2" tabindex="-1"></a></span>
<span id="cb308-3"><a href="filtering-smoothing.html#cb308-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>core1) <span class="sc">+</span></span>
<span id="cb308-4"><a href="filtering-smoothing.html#cb308-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> yr, <span class="at">y =</span> mm)) <span class="sc">+</span></span>
<span id="cb308-5"><a href="filtering-smoothing.html#cb308-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Ring Width (mm)&quot;</span>,</span>
<span id="cb308-6"><a href="filtering-smoothing.html#cb308-6" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Sample 641114 Schulman Old Tree No. 1, Mesa Verde&quot;</span>)</span></code></pre></div>
<p><img src="08TimeSeries-Filters_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>We will fit a loess model of ring wing width as a function of time. Note this is a first-order polynomial (<code>degree = 1</code>) while the default is to use a 2nd-order polynomial. The argument <code>span</code> gives the percentage of the points used. Since there are 694 this corresponds to 69 years being used at each fit.</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="filtering-smoothing.html#cb309-1" tabindex="-1"></a>loessModel <span class="ot">&lt;-</span> <span class="fu">loess</span>(<span class="at">formula =</span> mm <span class="sc">~</span> yr, <span class="at">data =</span> core1, <span class="at">degree =</span> <span class="dv">1</span>, <span class="at">span =</span> <span class="fl">0.05</span>)</span>
<span id="cb309-2"><a href="filtering-smoothing.html#cb309-2" tabindex="-1"></a>loessFit <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">augment</span>(loessModel)</span></code></pre></div>
<p>Because the output object from <code>loessModel</code> model is, well, yucky, I used <code>augment</code> from <code>broom</code> to put it in a nicer format.</p>
<p>Here is a plot of the fit.</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="filtering-smoothing.html#cb310-1" tabindex="-1"></a>loessFit <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb310-2"><a href="filtering-smoothing.html#cb310-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> yr, <span class="at">y =</span> mm), <span class="at">color=</span><span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb310-3"><a href="filtering-smoothing.html#cb310-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> yr, <span class="at">y =</span> .fitted), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb310-4"><a href="filtering-smoothing.html#cb310-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Ring Width (mm)&quot;</span>, <span class="at">caption =</span> <span class="st">&quot;5% loess smooth&quot;</span>,</span>
<span id="cb310-5"><a href="filtering-smoothing.html#cb310-5" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Sample 641114 Schulman Old Tree No. 1, Mesa Verde&quot;</span>)</span></code></pre></div>
<p><img src="08TimeSeries-Filters_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>If instead of a proportion of the data, we can specify a number of points (years) to use like we did above. E.g., 100-year smooth. Is 100 years the right value? Nobody can really say. But this is one approach for filtering out this relatively low-frequency (100 period = 0.01 f).</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="filtering-smoothing.html#cb311-1" tabindex="-1"></a>loessModel <span class="ot">&lt;-</span> <span class="fu">loess</span>(<span class="at">formula =</span> mm <span class="sc">~</span> yr, <span class="at">data =</span> core1, <span class="at">degree =</span> <span class="dv">1</span>, <span class="at">span =</span> <span class="dv">100</span><span class="sc">/</span>n)</span>
<span id="cb311-2"><a href="filtering-smoothing.html#cb311-2" tabindex="-1"></a>loessFit <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">augment</span>(loessModel)</span>
<span id="cb311-3"><a href="filtering-smoothing.html#cb311-3" tabindex="-1"></a>loessFit <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb311-4"><a href="filtering-smoothing.html#cb311-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> yr, <span class="at">y =</span> mm), <span class="at">color=</span><span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb311-5"><a href="filtering-smoothing.html#cb311-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> yr, <span class="at">y =</span> .fitted), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb311-6"><a href="filtering-smoothing.html#cb311-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Ring Width (mm)&quot;</span>, <span class="at">caption =</span> <span class="st">&quot;100-year loess smooth&quot;</span>,</span>
<span id="cb311-7"><a href="filtering-smoothing.html#cb311-7" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Sample 641114 Schulman Old Tree No. 1, Mesa Verde&quot;</span>)</span></code></pre></div>
<p><img src="08TimeSeries-Filters_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>We can make the RWI via:</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="filtering-smoothing.html#cb312-1" tabindex="-1"></a>core1<span class="sc">$</span>rwi <span class="ot">&lt;-</span> loessFit<span class="sc">$</span>mm<span class="sc">/</span>loessFit<span class="sc">$</span>.fitted</span>
<span id="cb312-2"><a href="filtering-smoothing.html#cb312-2" tabindex="-1"></a><span class="fu">names</span>(core1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>, <span class="st">&quot;Ring Width (mm)&quot;</span>,<span class="st">&quot; Ring Width Index (RWI)&quot;</span>)</span>
<span id="cb312-3"><a href="filtering-smoothing.html#cb312-3" tabindex="-1"></a>core1 <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="sc">-</span>Year) <span class="sc">%&gt;%</span></span>
<span id="cb312-4"><a href="filtering-smoothing.html#cb312-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb312-5"><a href="filtering-smoothing.html#cb312-5" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb312-6"><a href="filtering-smoothing.html#cb312-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb312-7"><a href="filtering-smoothing.html#cb312-7" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Sample 641114 Schulman Old Tree No. 1, Mesa Verde&quot;</span>) <span class="sc">+</span></span>
<span id="cb312-8"><a href="filtering-smoothing.html#cb312-8" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows=</span><span class="fu">vars</span>(name),<span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="08TimeSeries-Filters_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
</div>
<div id="the-case-of-the-poorly-launched-sensors" class="section level2 hasAnchor" number="11.5">
<h2><span class="header-section-number">11.5</span> The Case of the Poorly-Launched Sensors<a href="filtering-smoothing.html#the-case-of-the-poorly-launched-sensors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s look at another use for filters. You have a critical bit weather data from a temperature logger and a solar radiation sensor that you inherited for your work. Your thesis, tenure packet, soul, whatever depend on faithful analysis. As is common with inherited data, you can’t control the quality. It turns out that these sensors were deployed by a hapless undergrad. The loggers were supposed to be deployed to record hourly over the summer of 2014. They were supposed to be launched synchronously on June 1 at midnight. Beware! The good-for-nothing adviser didn’t read the manual or spend enough time with the aforementioned undergrad. Regrettably, the temperature data started collecting at three minutes past the hour and collected every other hour. The radiation sensor was launched correctly but the cable wasn’t connected well enough and as a result there are a bunch of missing data over the summer.</p>
<p>Load the data in as two <code>data.frame</code> objects. Here is a summary and plot.</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="filtering-smoothing.html#cb313-1" tabindex="-1"></a>rad <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data/rad.rds&quot;</span>)</span>
<span id="cb313-2"><a href="filtering-smoothing.html#cb313-2" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data/tmp.rds&quot;</span>)</span>
<span id="cb313-3"><a href="filtering-smoothing.html#cb313-3" tabindex="-1"></a><span class="fu">summary</span>(tmp[,<span class="dv">2</span>])</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  -5.818   7.889  10.490  10.537  13.432  21.640</code></pre>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="filtering-smoothing.html#cb315-1" tabindex="-1"></a><span class="fu">summary</span>(rad[,<span class="dv">2</span>])</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
##     0.0     0.0    49.5   280.0   530.0  1239.0     220</code></pre>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="filtering-smoothing.html#cb317-1" tabindex="-1"></a>pTmp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tmp) <span class="sc">+</span></span>
<span id="cb317-2"><a href="filtering-smoothing.html#cb317-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>DateTime,<span class="at">y=</span>tmp)) <span class="sc">+</span></span>
<span id="cb317-3"><a href="filtering-smoothing.html#cb317-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Date&quot;</span>,<span class="at">y=</span><span class="fu">expression</span>(degree <span class="sc">*</span> C),</span>
<span id="cb317-4"><a href="filtering-smoothing.html#cb317-4" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Air Temperature&quot;</span>) <span class="sc">+</span> </span>
<span id="cb317-5"><a href="filtering-smoothing.html#cb317-5" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb317-6"><a href="filtering-smoothing.html#cb317-6" tabindex="-1"></a>pRad <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rad) <span class="sc">+</span></span>
<span id="cb317-7"><a href="filtering-smoothing.html#cb317-7" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>DateTime,<span class="at">y=</span>rad)) <span class="sc">+</span></span>
<span id="cb317-8"><a href="filtering-smoothing.html#cb317-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Date&quot;</span>,<span class="at">y=</span><span class="fu">expression</span>(W<span class="sc">~</span>m<span class="sc">^-</span><span class="dv">2</span>),</span>
<span id="cb317-9"><a href="filtering-smoothing.html#cb317-9" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Radiation&quot;</span>) <span class="sc">+</span> </span>
<span id="cb317-10"><a href="filtering-smoothing.html#cb317-10" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb317-11"><a href="filtering-smoothing.html#cb317-11" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(pTmp,pRad)  </span></code></pre></div>
<p><img src="08TimeSeries-Filters_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Here is a better look at the times:</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="filtering-smoothing.html#cb318-1" tabindex="-1"></a><span class="fu">head</span>(tmp<span class="sc">$</span>DateTime)</span></code></pre></div>
<pre><code>## [1] &quot;2014-06-01 00:03:00 UTC&quot; &quot;2014-06-01 02:03:00 UTC&quot;
## [3] &quot;2014-06-01 04:03:00 UTC&quot; &quot;2014-06-01 06:03:00 UTC&quot;
## [5] &quot;2014-06-01 08:03:00 UTC&quot; &quot;2014-06-01 10:03:00 UTC&quot;</code></pre>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="filtering-smoothing.html#cb320-1" tabindex="-1"></a><span class="fu">head</span>(rad<span class="sc">$</span>DateTime)</span></code></pre></div>
<pre><code>## [1] &quot;2014-06-01 00:00:00 UTC&quot; &quot;2014-06-01 01:00:00 UTC&quot;
## [3] &quot;2014-06-01 02:00:00 UTC&quot; &quot;2014-06-01 03:00:00 UTC&quot;
## [5] &quot;2014-06-01 04:00:00 UTC&quot; &quot;2014-06-01 05:00:00 UTC&quot;</code></pre>
<div id="fix-time-on-temperature" class="section level3 hasAnchor" number="11.5.1">
<h3><span class="header-section-number">11.5.1</span> Fix time on temperature<a href="filtering-smoothing.html#fix-time-on-temperature" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The times on the temperature data are pretty easy to fix. They are off by three minutes from what you wanted. Now three minutes is not a big deal. Let’s just snap those back to the hour. We can do that easily buy subtracting 180 seconds from each one. The dates and times in the temperature <code>data.frame</code> is a <code>POSIXct</code> object. Internally, these are a measure of seconds from an origin (usually January 1, 1970). Just subtract the requisite number of seconds:</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="filtering-smoothing.html#cb322-1" tabindex="-1"></a>tmp<span class="sc">$</span>DateTime <span class="ot">&lt;-</span> tmp<span class="sc">$</span>DateTime <span class="sc">-</span> <span class="dv">180</span> </span>
<span id="cb322-2"><a href="filtering-smoothing.html#cb322-2" tabindex="-1"></a><span class="fu">head</span>(tmp<span class="sc">$</span>DateTime)</span></code></pre></div>
<pre><code>## [1] &quot;2014-06-01 00:00:00 UTC&quot; &quot;2014-06-01 02:00:00 UTC&quot;
## [3] &quot;2014-06-01 04:00:00 UTC&quot; &quot;2014-06-01 06:00:00 UTC&quot;
## [5] &quot;2014-06-01 08:00:00 UTC&quot; &quot;2014-06-01 10:00:00 UTC&quot;</code></pre>
<p>Times are fixed. That was easy.</p>
</div>
<div id="fill-missing-data-on-radiation" class="section level3 hasAnchor" number="11.5.2">
<h3><span class="header-section-number">11.5.2</span> Fill missing data on radiation<a href="filtering-smoothing.html#fill-missing-data-on-radiation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Ok. That was a fun excursion working with <code>zoo</code>. But let’s use filters to impute data gaps. About 10% of the data are missing on the radiation <code>data.frame</code>. Curses. Let’s interpolate it. First we will make it a <code>zoo</code> object and make a plot of the first 100 observations so we can see the problem more clearly.</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="filtering-smoothing.html#cb324-1" tabindex="-1"></a>zooRad <span class="ot">&lt;-</span> <span class="fu">zoo</span>(rad[,<span class="dv">2</span>],rad[,<span class="dv">1</span>])</span>
<span id="cb324-2"><a href="filtering-smoothing.html#cb324-2" tabindex="-1"></a><span class="co"># let&#39;s look at the first 100 observations.</span></span>
<span id="cb324-3"><a href="filtering-smoothing.html#cb324-3" tabindex="-1"></a><span class="fu">plot</span>(zooRad[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>],<span class="at">type=</span><span class="st">&quot;b&quot;</span>,<span class="at">pch=</span><span class="dv">20</span>,<span class="at">ylab=</span><span class="fu">expression</span>(W<span class="sc">~</span>m<span class="sc">^-</span><span class="dv">2</span>))</span></code></pre></div>
<p><img src="08TimeSeries-Filters_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>The <code>zoo</code> package has several ways of filling <code>NA</code> values. Let’s run a linear interpolation and a cubic smoothing spline. In this case, the results are very similar because the radiation data are quite well behaved (sun comes up and sun goes down).</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="filtering-smoothing.html#cb325-1" tabindex="-1"></a>zooRad.approx <span class="ot">&lt;-</span> <span class="fu">na.approx</span>(zooRad)</span>
<span id="cb325-2"><a href="filtering-smoothing.html#cb325-2" tabindex="-1"></a>zooRad.spline <span class="ot">&lt;-</span> <span class="fu">na.spline</span>(zooRad)</span>
<span id="cb325-3"><a href="filtering-smoothing.html#cb325-3" tabindex="-1"></a><span class="fu">plot</span>(zooRad.approx[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>],<span class="at">type=</span><span class="st">&quot;b&quot;</span>,<span class="at">pch=</span><span class="dv">20</span>,<span class="at">ylab=</span><span class="fu">expression</span>(W<span class="sc">~</span>m<span class="sc">^-</span><span class="dv">2</span>),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb325-4"><a href="filtering-smoothing.html#cb325-4" tabindex="-1"></a><span class="fu">lines</span>(zooRad.spline[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>],<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">lty=</span><span class="st">&quot;dotted&quot;</span>)</span>
<span id="cb325-5"><a href="filtering-smoothing.html#cb325-5" tabindex="-1"></a><span class="fu">lines</span>(zooRad[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>],<span class="at">col=</span><span class="st">&quot;grey&quot;</span>,<span class="at">lwd=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="08TimeSeries-Filters_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>That was easy too. Note the different ways of filling in the missing data. Look at <code>na.locf</code> as well. They all use some kind of filtering to impute the missing data.</p>
</div>
</div>
<div id="your-work-7" class="section level2 hasAnchor" number="11.6">
<h2><span class="header-section-number">11.6</span> Your work<a href="filtering-smoothing.html#your-work-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="filter" class="section level3 hasAnchor" number="11.6.1">
<h3><span class="header-section-number">11.6.1</span> Filter<a href="filtering-smoothing.html#filter" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Fit some smooths to the data below. What’s looks good? What feels “right” in terms of a good filter?</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="filtering-smoothing.html#cb326-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb326-2"><a href="filtering-smoothing.html#cb326-2" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb326-3"><a href="filtering-smoothing.html#cb326-3" tabindex="-1"></a>              <span class="at">y =</span> <span class="fu">c</span>(<span class="fu">arima.sim</span>(<span class="at">model =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>), </span>
<span id="cb326-4"><a href="filtering-smoothing.html#cb326-4" tabindex="-1"></a>                                           <span class="at">ar=</span><span class="fu">c</span>(<span class="fl">0.7</span>, <span class="sc">-</span><span class="fl">0.2</span>), <span class="at">ma =</span> <span class="sc">-</span><span class="fl">0.4</span>), </span>
<span id="cb326-5"><a href="filtering-smoothing.html#cb326-5" tabindex="-1"></a>                              <span class="at">n=</span>n)))</span>
<span id="cb326-6"><a href="filtering-smoothing.html#cb326-6" tabindex="-1"></a>dat<span class="sc">$</span>y <span class="ot">&lt;-</span> dat<span class="sc">$</span>y <span class="sc">+</span> </span>
<span id="cb326-7"><a href="filtering-smoothing.html#cb326-7" tabindex="-1"></a>  <span class="fl">0.3</span> <span class="sc">*</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">100</span> <span class="sc">*</span> dat<span class="sc">$</span>x) <span class="sc">+</span></span>
<span id="cb326-8"><a href="filtering-smoothing.html#cb326-8" tabindex="-1"></a>  <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">200</span> <span class="sc">*</span> dat<span class="sc">$</span>x)</span>
<span id="cb326-9"><a href="filtering-smoothing.html#cb326-9" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dat,<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y)) <span class="sc">+</span></span>
<span id="cb326-10"><a href="filtering-smoothing.html#cb326-10" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="08TimeSeries-Filters_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
<div id="revisit-the-case-of-the-poorly-launched-sensors" class="section level3 hasAnchor" number="11.6.2">
<h3><span class="header-section-number">11.6.2</span> Revisit the case of the poorly launched sensors<a href="filtering-smoothing.html#revisit-the-case-of-the-poorly-launched-sensors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the poorly launched sensors debacle there were a few problems. The radiation data was spotty but collecting every hour (2208 observations). The temp data was collecting every other hour (1104 observations) AND doing so at three minutes after the hour. We fixed the second part but not the first one. Your task is to align these data sets. They have to be hourly resolution for some reason you can invent. Figure out a way to take the <code>tmp</code> object above and change it to have hourly rather than two hourly resolution. I can think of several ways to do it but I’m going to leave you up to your own devices to figure out a way to do it. When you are done the radiation and temperature data should be aligned with 2208 observations each.</p>
</div>
<div id="write-up-and-reflect-7" class="section level3 hasAnchor" number="11.6.3">
<h3><span class="header-section-number">11.6.3</span> Write Up and Reflect<a href="filtering-smoothing.html#write-up-and-reflect-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pass in a R Markdown doc with your analysis. Leave all code visible, although you may quiet messages and warnings if desired. Turn in your knitted html. The last section of your document should include a reflection where you explain how it all went. What triumphs did you have? What is still confusing?</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="the-freqs-come-out-at-night.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section",
    "scroll_highlight": true
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
